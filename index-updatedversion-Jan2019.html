
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119794696-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-119794696-1');
    </script>


    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="//igv.org/web/img/favicon.ico">
    <title>ImmuneRegulation</title>

    <!-- Bootstrap CSS - NOT REQUIRED FOR IGV -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    
    <!-- jQuery UI CSS -->
    <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"/>

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

    <link rel="shortcut icon" href="//igv.org/web/img/favicon.ico">

    <!-- IGV CSS -->
    <link rel="stylesheet" type="text/css" href="https://igv.org/web/beta/igv-beta.css">
    <!--link rel="stylesheet" type="text/css" href="https://igv.org/web/jb/snapshot/css/igv.css"-->
    <!--link rel="stylesheet" type="text/css" href="https://igv.org/web/jb/release/current/igv-beta.css"-->
    <!--link rel="stylesheet" type="text/css" href="http://igv.org/web/release/2.0.0-beta1/dist/igv-all.css"-->
    <!--link rel="stylesheet" type="text/css" src="./css/beta/igv-beta.css"-->

    <!-- IGV GTEx CSS -->
    <!--link rel="stylesheet" href="http://igv.org/web/release/1.0.1/igv-1.0.1.css?v=cl80"-->

    <!-- IGV Release CSS -->
    <!--link rel="stylesheet" type="text/css" href="https://igv.org/web/release/1.0.7/igv-1.0.7.css"-->

    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.css">

    <!--link rel="stylesheet" type="text/css" src="./css/jquery.dataTables.min.css"-->
    <link rel="stylesheet" type="text/css" src="./css/typeahead.css">

    <!-- jQuery JS -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>

    <!-- Tooltips -->
    <script src="./js/popper.min.js"></script>

    <!-- Bootstrap JS -  NOT REQUIRED FOR IGV -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--script src="./js/bootstrap.js"></script-->

    <!-- IGV TEST JS-->
    <!-- https://igv.org/web/test/multilocus/igv-multilocus.js -->
    <!-- http://igv.org/web/release/1.0.1/igv-1.0.1.min.js -->
    <!-- https://igv.org/web/beta/igv-beta.js-->

    <!-- IGV JS - DEV -->
    <!--script src="./js/igv-selim.js"></script-->

    <!-- IGV JS - Deneme DEV -->
    <script src="./js/igv-immReg-deneme.js"></script>
    <!--script src="http://igv.org/web/release/2.0.0-beta1/dist/igv.min.js"></script-->
    <!--script src="https://igv.org/web/beta/igv.js"></script-->


    <script src="./js/savePng.js"></script>
    <script src="./js/jsPDF2.js"></script>
    <script src="./js/jsPDF.js"></script>
    <script src="./js/svg2pdf.js"></script>
    <script src="./js/saveSvgAsPng.js"></script>

    <!--script src="./js/jsPDF.js"></script-->
    <script src="./js/savePdf.js"></script>
    <script src="./js/html2canvas.js"></script>
    <script src="./js/FileSaver.js"></script>
    

    <!-- IGV GTEx JS -->
    <!--script src="http://igv.org/web/release/1.0.1/igv-1.0.1.min.js" type="text/javascript"></script-->
    
    <!-- IGV Release JS -->
    <!--script type="text/javascript" src="https://igv.org/web/release/1.0.7/igv-1.0.7.js"></script-->

    <!-- IGV PROD JS -->
    <!--script type="text/javascript" src="https://igv.org/web/beta/igv-beta.js"></script-->

    <!-- D3 JS -->
    <script src='https://d3js.org/d3.v3.min.js'></script>

    <!-- Bootstrap Multi-Select -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.min.js" integrity="sha256-1fK87Pt9T7XXn/Vj3CWSfJlZkL5f73092A8YL7p7avc=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css" integrity="sha256-O1jJhOIWWDc3wq75g7aXDl7aEQT2XPkieX/Mz/u4hQ0=" crossorigin="anonymous"/>    
    

    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!-- DataTables JS -->
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.js"></script>
    <!--script type="text/javascript" charset="utf8" src="./js/jquery.dataTables.min.js"></script-->
    <script src="https://cdn.rawgit.com/eligrey/canvas-toBlob.js/f1a01896135ab378aa5c0118eadd81da55e698d8/canvas-toBlob.js"></script>
    <script src="https://cdn.rawgit.com/eligrey/FileSaver.js/e9d941381475b5df8b7d7691013401e171014e89/FileSaver.min.js"></script>
    
    <script src="./js/type.js"></script>
    <script src="./js/genenames.js"></script>
    <script src="./js/uploadFile.js"></script>
    <script src="./js/uploadFile2.js"></script>
    <script src="./js/underscore-min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.0.1/spin.min.js'></script>
     <!--script type="text/javascript" src="./js/gwas/t2dVariantSource.js"></script>
    <script type="text/javascript" src="./js/gwas/gwasTrack.js"></script-->

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

    <script type="text/javascript">

        $( function() {
            $(document).tooltip({
              position: {
                my: "center bottom-20",
                at: "center top",
                using: function( position, feedback ) {
                  $( this ).css( position );
                  $( "<div>" )
                    .addClass( "arrow" )
                    .addClass( feedback.vertical )
                    .addClass( feedback.horizontal )
                    .appendTo( this );
                }
              }
            });
        } );

        $(document).ready(function() {
            $('#datasetT').multiselect({
                enableClickableOptGroups: true,
                enableCollapsibleOptGroups: true,
                buttonWidth: '350px',
                nonSelectedText: 'Choose dataset(s)'
            });
            $('.multiselect-container').find(".caret").click();

            $("body").tooltip({ selector: '[data-toggle=tooltip]' });

            $("#studyEntryRow").hide();

            $("#operationEntryRow").hide();

            //User Studies...
            $("#userListMain").hide();
            $("#userListCis").hide();
            $("#userListTrans").hide();

            $("#allStudies li:contains(User)").hide();

            //$("#userListTrans0").hide();

            //$("#userListInput").hide();

            //Multiple Select Deneme
        /*    $('#geneDataSelect').multiselect({
                enableFiltering: true,
                includeSelectAllOption: true,
                maxHeight: 200
            }); */


            //Update studyCountText 
            var allcheckboxes = document.querySelectorAll('input.studyopt');
            
            for(var i = 0; i < allcheckboxes.length; i++) {
                allcheckboxes[i].onclick = function() {
                    var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 

                    if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
                }
              
            } 
            

            //Emory Checkboxes 
            var emorycheckboxes = document.querySelectorAll('input.EmoryOption');
            var emorycheckall = document.getElementById('EmoryCheckAll');

            for(var i = 0; i < emorycheckboxes.length; i++) {
                emorycheckboxes[i].onclick = function() {
                    var emoryCheckCount = document.querySelectorAll('input.EmoryOption:checked').length;
                    emorycheckall.checked = emoryCheckCount > 0;
                    emorycheckall.indeterminate = emoryCheckCount > 0 && emoryCheckCount < emorycheckboxes.length;

                    var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected";

                    if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
              }
            }

            emorycheckall.onclick = function() {
              for(var i = 0; i < emorycheckboxes.length; i++) {
                    emorycheckboxes[i].checked = this.checked;
              }

                var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected";
                
                if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
            }

            //Mayo Checkboxes 
            var mayocheckboxes = document.querySelectorAll('input.MayoOption');
            var mayocheckall = document.getElementById('MayoCheckAll');

            for(var i = 0; i < mayocheckboxes.length; i++) {
                mayocheckboxes[i].onclick = function() {
                    var mayoCheckCount = document.querySelectorAll('input.MayoOption:checked').length;
                    mayocheckall.checked = mayoCheckCount > 0;
                    mayocheckall.indeterminate = mayoCheckCount > 0 && mayoCheckCount < mayocheckboxes.length;

                    var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected";

                    if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
              }
            }

            mayocheckall.onclick = function() {
              for(var i = 0; i < mayocheckboxes.length; i++) {
                    mayocheckboxes[i].checked = this.checked;
              }

                var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected";

                if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
            } 


            //Yale Checkboxes 
            var yalecheckboxes = document.querySelectorAll('input.YaleOption');
            var yalecheckall = document.getElementById('YaleCheckAll');

            for(var i = 0; i < yalecheckboxes.length; i++) {
                yalecheckboxes[i].onclick = function() {
                    var yaleCheckCount = document.querySelectorAll('input.YaleOption:checked').length;
                    yalecheckall.checked = yaleCheckCount > 0;
                    yalecheckall.indeterminate = yaleCheckCount > 0 && yaleCheckCount < yalecheckboxes.length;
                    
                    var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 

                    if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
              }
            }

            yalecheckall.onclick = function() {
                for(var i = 0; i < yalecheckboxes.length; i++) {
                    yalecheckboxes[i].checked = this.checked;
                    
                }
                    var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
                    document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected";

                    if(allcheckedcount > 0)
                        document.getElementById('deselectDiv').style.visibility = "visible";

                    else
                        document.getElementById('deselectDiv').style.visibility = "hidden";
            }


        });

    
    </script>

<style type="text/css">
    
.ui-tooltip, .arrow:after {
    background: white;
    border: 2px solid white;
  }
  .ui-tooltip {
    padding: 10px 20px;
    color: black;
    border-radius: 10px;
    font: bold 14px "Helvetica Neue", Sans-Serif;
    box-shadow: 0 0 7px black;
    opacity: 0.9;
  }
  .arrow {
    width: 70px;
    height: 16px;
    overflow: hidden;
    position: absolute;
    left: 50%;
    margin-left: -35px;
    bottom: -16px;
  }
  .arrow.top {
    top: -16px;
    bottom: auto;
  }
  .arrow.left {
    left: 20%;
  }
  .arrow:after {
    content: "";
    position: absolute;
    left: 20px;
    top: -20px;
    width: 25px;
    height: 25px;
    box-shadow: 6px 5px 9px -9px black;
    -webkit-transform: rotate(45deg);
    -ms-transform: rotate(45deg);
    transform: rotate(45deg);
  }
  .arrow.top:after {
    bottom: -20px;
    top: auto;
  }


#custom-search-input {
    margin:0;
    margin-top: 10px;
    padding: 0;
}
 
#custom-search-input .search-query {
    padding-right: 3px;
    padding-right: 4px \9;
    padding-left: 3px;
    padding-left: 4px \9;
    /* IE7-8 doesn't have border-radius, so don't indent the padding */

    margin-bottom: 0;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
}
 
#custom-search-input button {
    border: 0;
    background: none;
    /** belows styles are working good */
    padding: 2px 5px;
    margin-top: 2px;
    position: relative;
    left: -28px;
    /* IE7-8 doesn't have border-radius, so don't indent the padding */
    margin-bottom: 0;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
    color:#D9230F;
}
 
.search-query:focus + button {
    z-index: 3;   
}

.graph-svg-component {
    background-color: AliceBlue;
}

.filter {
  display: inline-block;
}

#geneSearch, #uploadStudy, #saveModal, #vizListButton {
    background: #1974B8;  
}

#geneSearch:hover, #uploadStudy:hover, #saveModal:hover, #vizListButton:hover {
    background: #035b9c;   
}

#geneSearch:active, #vizListButton:active {
    background: #1974B8;   
}

.btn, .btn-primary {
    background: white;
    padding: 14px 24px;
    font-weight: 400;
    letter-spacing: 1px;
    border-radius: 0;
    border: 1 solid;
    border-color: #bbb;
}

.btn-group, .btn-group-vertical {
    margin-left: 10px;
}

.btn:focus, .btn:active:focus, .btn.active:focus {
    outline: 0 none;
    border: 2 solid;
    border-color: #bbb;
}

.btn-primary.active, .btn-primary:focus, .btn-primary:active, .open > .dropdown-toggle.btn-primary {
    background: lightgray;
    color: #000;
    
    box-shadow: none;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary:hover {
    background: #bbb;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary:active, .btn-primary.raised.active {
    background: lightgray;
    box-shadow: none;
    margin-bottom: -3px;
    margin-top: 3px;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary.disabled, .btn-primary.disabled:focus, .btn-primary.disabled:active {
    background: lightgray;
    color: white;
    opacity: .7;
    border: 1 solid;
    border-color: #bbb;
}

.multiselect {
    padding-bottom: 10px;
    padding-top: 10px;
}

.multiselect-clear-filter {
    padding-bottom: 5px;
    padding-top: 5px;
    padding-right: 10px;
    padding-left: 10px;
}

circle {
    fill-opacity: .7;
    fill: rgb(30,144,255);
    stroke: #aaa; 
}

circle:hover {
  fill: red;
  stroke: #ccc;
}

#circle-leg-1 {
    fill-opacity: .9;
    fill: rgb(200,200,200);
    stroke: #aaa;
}

#circle-leg-2 {
    fill-opacity: .9;
    fill: rgb(30,144,255);
    stroke: rgb(30,144,255);
}

#circle-leg-3 {
    fill-opacity: .9;
    fill: rgb(240,20,20);
    stroke: rgb(240,20,20);
}

#circle-leg-4 {
    fill-opacity: .9;
    fill: rgb(0,0,0);
    stroke: #aaa;
}

caption {
    font-size:medium;
    text-align: center;
    color: #035b9c;
    font-weight:500;

}

path.line {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

path.area {
  fill: #e7e7e7;
}

.axis path,
.axis line {
    fill: none;
    stroke: black;
    shape-rendering: crispEdges;
}

/*.axis {
  shape-rendering: crispEdges;
}*/

/*.x.axis line {
  stroke: #fff;
}

.x.axis .minor {
  stroke-opacity: .5;
}

.x.axis path {
  display: none;
}*/

.y.axis line,
.y.axis path {
  fill: none;
  stroke: #000;
}

.axis--y text {
  font: oblique 10px Georgia, serif;
}


.glyphicon + .tooltip > .tooltip-inner {
    /*position: absolute;*/
    background-color: white; 
      color: black; 
      border: 1px solid gray; 
      padding: 10px;
      font-size: 12px;
      height:auto;

}

.glyphicon + .tooltip {
   background-color: white;

}

.btn + .tooltip.bottom > .tooltip-inner {
    position: absolute;         
    text-align: left;         
    width: 160px;                    
    height: auto;                   
    padding: 10px;               
    font: 12px sans-serif;      
    background: lightsteelblue; 
    border: 0px;        
    /* box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4); */         
    pointer-events: none;  
    color:black;   
  }


div.tooltip {   
    position: absolute;         
    text-align: left;         
    width: 200px;                    
    height: auto;                   
    padding: 10px;               
    font: 12px sans-serif;      
    background: lightsteelblue; 
    border: 0px;        
    border-radius: 8px;
    /* box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4); */      
    pointer-events: none;  
    color:black;         
}

.glyphicon-arrow-down {
    font-size: large;
}

.glyphicon-arrow-down:hover {
    color: navy;
    font-size: x-large;
}

.glyphicon-arrow-up {
    font-size: large;
}

.glyphicon-arrow-up:hover {
    color: navy;
    font-size: x-large;
}

.badge {
    background: white;
    color: steelblue; 
    /*font-size: small; */
    padding-top: 5px;
    padding-bottom: 5px;
}

.navbar-nav:hover {
    background: #77b7ec;
}

.navbar-nav>.open {
    background: #1974B8;
}

.navbar-nav > li > a:active {
    font-size: larger;
}

.navbar-nav > li > a:focus {
    font-size: larger;

}

.navbar-inverse .navbar-nav>.open>a, .navbar-inverse .navbar-nav>.open>a:focus, .navbar-inverse .navbar-nav>.open>a:hover {
    background: #77b7ec;
}




</style>

</head>



<body role="document" style="background: #eee;">

<nav class="navbar navbar-inverse navbar-fixed-top" style= "margin-botom:0px;">

    <div class="container-fluid" style = "background: #1974B8;">
        <div class="navbar-header navbar-nav">
            <a class="navbar-brand" style="color: white; margin-left: 10px;" href="https://www.immunespace.org/">ImmuneSpace</a>
        </div>
        <div id="navbar">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle navbar-brand" style="color: white; margin-left: 10px;" data-toggle="dropdown" role="button" aria-expanded="false">immuneRegulation
                        <span class="caret"></span></a>
                    <ul class="dropdown-menu" style="margin-left: 10px;" role="menu">
                        <li>
                            <a href="index.html" style="font-size:medium;">Query Browser</a>
                        </li> 
                                              
                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle navbar-brand" style="color: white; margin-left: 10px;" data-toggle="dropdown" role="button" aria-expanded="false">Example Queries
                        <span class="caret"></span></a>
                    <ul class="dropdown-menu" style="margin-left: 10px; font-size:medium;" role="menu">
                        <li>
                            <a id="exQuery1" href="#" onclick="exampleQuery1();">Example 1 - Cis-eQTLs for JAK2 gene in monocyte exposure studies</a>
                        </li> 
                        <li>
                            <a id="exQuery2" href="#" onclick="exampleQuery2();">Example 2 - Trans-eQTLs for Cytokine Pathway genes in Whole-blood meta-analysis study</a>
                        </li> 
                        <li>
                            <a id="exQuery3" href="#" onclick="exampleQuery3();">Example 3 - Transcription Factor studies with hits for IL17A gene </a>
                        </li>
                                              
                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="tutorials.html">Tutorials</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="feedback.html">Contact Us</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="faq.html">FAQ</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://www.mssm.edu" style = "padding-top: 0px; padding-bottom: 0px;">
                    <img src="images/logo.gif" alt="Mount Sinai" height="50" style = "margin-right: 120px;">
                    <!--span class="glyphicon glyphicon-user"></span> Sign Up -->
                    </a>
                </li>
                <li> </li>
            </ul>

        </div>
        <!--/.nav-collapse -->
    </div>

</nav>



<div class="container" id = "mainContainer" style="background: white; padding-bottom: 50px;"> <!-- container start -->

    <div class="row" id="immRegExpRow" style="margin-top: 60px;margin-left:-5px;margin-right:-5px; padding-top:10px;">      
                <p style="font-size:medium; text-align:center;"><strong> immuneRegulation </strong> provides visualization, exploration, and download of large-number of regulatory data through a single, and intuitive interface.
                 </p>      
    </div>

    <div class="row" id="geneEntryRow" style="border:1px solid #888888; margin-top: 10px;margin-left:-5px;margin-right:-5px; padding-top:10px;">
        <div class="col-md-3" style="font-size:medium;">
                <p style=""><strong> Enter Gene(s): </strong></p>        
        </div>
        
        <div class="col-md-6" style="font-size:medium;">
            <textarea id="geneVal" class="typeahead" placeholder="Enter HUGO Gene symbols" cols="57" rows="4" style="padding-top:0px; margin-bottom:5px; overflow:inherit;overflow-x: hidden;"></textarea>
        </div>
        <div class="col-md-3" id="extraGene" style="font-size:16px; padding-top:15px; color:red; visibility:hidden;">
                <p style=""> Please enter a single gene in the gene-box for 'cis-eQTL' queries. </p>               
        </div>
    </div>

    
    <div class="row" id= "browseRow" style="padding-bottom: 1px; margin-top: 20px; margin-bottom: 20px; margin-right: -7px; margin-left: -7px; padding-bottom: -10px; background: #ddd; border-style: solid; border-width: 1px; border-radius: 1px; border-color: #888888; height:390px; ">
        
        <div class="row" style="background: white; margin:0px; padding-bottom: 0px; border: 1px solid lightgray;">
            <div class="col-md-3" style = "font-size:large; padding-top:20px;">
                <span style="margin-right:5px;" class="glyphicon glyphicon-list"> </span> <strong> Study List: </strong>
            </div>
            
            <div class="col-md-2" style = "font-size:medium; text-align:center; padding-top:20px;">
                <p id="studyCountText"> 0 studies selected </p> 
            </div>
            
            <div class="col-md-2" id="deselectDiv" style = "font-size:medium; text-align:center; padding-top:20px; visibility:hidden;">
                <a href="#" onclick = "deselectStudies()">  Deselect all </a> 
            </div>
            
            <div class="col-md-3" style = "font-size:medium; text-align:right; padding-top:20px; opacity:0.5;">
                <p> <strong>Study Type: </strong> </p>
                
            </div>
            <div class="col-md-2" style = "font-size:medium; color:#337ab7; text-align:left; padding-top:20px; opacity:0.5;">
                <p id="queryType"> Not Selected  </p>
                
            </div>

            
        </div>

        <div class="row" style="padding:0px; overflow: hidden; height:91%; margin:0px;">
            <div class="col-md-3" style="padding:0px; overflow: scroll; height:inherit; background:white;">
                <ul class="list-group" style="margin-bottom: 0px; font-size:initial;">

                    <li class="list-group-item" id="userListMain" style="color:black; background:#a1cce4;">
                        <span class="badge" id="userListCount">0</span>
                            <a href="#" onClick = filterUser()> &#x21E3; User Studies </a>
                    </li>
                    <li class="list-group-item" id="userListCis" style="color:black; padding-left:35px;background:#a1cce4;">
                        <span class="badge" id="userListCisCount">0</span>
                            <a href="#" onClick = filterCisUser()> &#x21B3; cis-eQTL</a>
                    </li>
                    <li class="list-group-item" id="userListTrans" style="color:black; padding-left:35px;background:#a1cce4;">
                        <span class="badge" id="userListTransCount">0</span>
                            <a href="#" onClick = filterTransUser()> &#x21B3; trans-eQTL</a>
                    </li>
                    <li class="list-group-item" id="listHIPC" style="color:black; background:#a1cce4;">
                        <span class="badge">22</span>
                            <a href="#" onClick = filterHIPC()> 
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span--> &#x21E3; HIPC Studies </a>
                    </li>
                    <li class="list-group-item" id="listCisHIPC" style="color:black; padding-left:35px; background:#a1cce4;">
                        <span class="badge">11</span>
                            <a href="#" onClick = filterCisHIPC()>
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span> 
                                <span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span--> &#x21B3; cis-eQTL</a>
                    </li>
                    <li class="list-group-item" id="listTransHIPC" style="color:black; padding-left:35px; background:#a1cce4;">
                        <span class="badge">11</span>
                            <a href="#" onClick = filterTransHIPC()>
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span>
                                <span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span--> &#x21B3; trans-eQTL</a>
                    </li>
                    <li class="list-group-item" id="listNonHIPC" style="color:black;background:#a1cce4;">
                        <span class="badge">37</span>
                            <a href="#" onClick = filterNonHIPC()>
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span--> &#x21E3; Non-HIPC Studies </a>
                    </li>
                    <li class="list-group-item" id="listCisNonHIPC" style="color:black; padding-left:35px;background:#a1cce4;">
                        <span class="badge">23</span>
                            <a href="#" onClick = filterCisNonHIPC()> 
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-menu-right"> </span>
                                <span style="margin-right:5px;" class="glyphicon glyphicon-option-horizontal"> </span--> &#x21B3; cis-eQTL</a>
                    </li>
                    <li class="list-group-item" id="listTransNonHIPC" style="color:black; padding-left:35px;background:#a1cce4;">
                        <span class="badge">14</span>
                            <a href="#" onClick = filterTransNonHIPC()> 
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-menu-right"> </span>
                                <span style="margin-right:5px;" class="glyphicon glyphicon-option-horizontal"> </span--> &#x21B3; trans-eQTL</a>
                    </li>
                    <li class="list-group-item" id="mainTF" style="color:black;background:#a1cce4;">
                        <span class="badge">1945</span>
                            <a href="#" onClick = filterTF()>
                                <!--span style="margin-right:5px;" class="glyphicon glyphicon-option-vertical"> </span--> &#x21E3; Transcription Factors </a>
                    </li>
                </ul>
            </div>

            <div class="col-md-9" style="padding-left:0px; overflow: scroll; height:inherit; padding-right:0px; background:white;">
                <ul class="list-group" id="allStudies" style="margin-bottom: 0px; font-size:initial;  ">
                    
                    <li class="list-group-item user" id="UserListTitle" style="color:black; padding-top:15px;padding-left:10px;">                        
                        <strong>User Studies</strong>                         
                    </li>

                    <li class="list-group-item user ucis" id="UserListCis0" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study101" value="on">
                        <span value="101" id="span1000">User</span>                          
                    </li>

                    <li class="list-group-item user ucis" id="UserListCis1" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study102" value="on">
                        <span value="102" id="span1001">User</span>                          
                    </li>

                    <li class="list-group-item user ucis" id="UserListCis2" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study103" value="on">
                        <span value="103" id="span1002">User</span>                          
                    </li>

                    <li class="list-group-item user utrans" id="UserListTrans0" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study111" value="on">
                        <span value="111" id="span1100">User</span>                          
                    </li>

                    <li class="list-group-item user utrans" id="UserListTrans1" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study112" value="on">
                        <span value="112" id="span1101">User</span>                          
                    </li>

                    <li class="list-group-item user utrans" id="UserListTrans2" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study113" value="on">
                        <span value="113" id="span1102">User</span>                          
                    </li>

                     <li class="list-group-item user" id="UserListCis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                      <!--  <input type="checkbox" class="studyopt Option" id="study102" value="on">
                        <span value="102" id="span102">User</span>        -->                  
                    </li>



                    <li class="list-group-item non-hipc" style="color:black; padding-top:15px;padding-left:10px;">                        
                        <strong>Non-HIPC Studies</strong>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                      
                        <strong>Whole Blood</strong>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="framingham" value="on">
                        <span value="11">Whole Blood - European American (Framingham Heart Study, NHLBI)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 5257 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" aria-hidden="true" data-toggle="tooltip" title="Framingham Heart Study, under the direction of the National Heart, Lung and Blood Institute (NHLBI), formerly known as the National Heart Institute, has been committed to identifying the common factors or characteristics that contribute to cardiovascular disease (CVD). Study began in 1948 by recruiting an Original Cohort of 5,209 men and women between the ages of 30 and 62 from the town of Framingham, Massachusetts, who had not yet developed overt symptoms of cardiovascular disease or suffered a heart attack or stroke."></span>   
                        <a href="https://www.framinghamheartstudy.org/" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;border-bottom:0px;padding-left:30px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="gtex" value="on">
                        <span value="12">Whole Blood - Mixed ethnicity - GTEx Consortium (Science, 2015)</span>    
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 338 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="The Genotype-Tissue Expression (GTEx) project aims to provide to the scientific community a resource with which to study human gene expression and regulation and its relationship to genetic variation. This project will collect and analyze multiple human tissues from donors who are also densely genotyped, to assess genetic variation within their genomes." aria-hidden="true"></span>
                        <a href="https://gtexportal.org/home/" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>
                    </li>
                   
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="westra" value="on">
                        <span value="13">Whole Blood - Meta-analysis - European (Nature Genetics, 2013)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 5311 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors performed expression quantitative trait locus (eQTL) meta-analysis in non-transformed peripheral blood samples from 5,311 individuals with replication in 2,775 individuals. They identified and replicated trans eQTLs for 233 SNPs (reflecting 103 independent loci) that were previously associated with complex traits at genome-wide significance." aria-hidden="true"></span> 
                        <a href="http://genenetwork.nl/bloodeqtlbrowser/" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="study14" value="on">
                        <span value="14">Whole Blood - European (Nature Genetics, 2017)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 2166 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors generated peripheral blood RNA–seq data from 2,116 unrelated individuals and systematically identified context-dependent eQTLs using a hypothesis-free strategy that does not require previous knowledge of the identity of the modifiers." aria-hidden="true"></span> 
                        <a href="https://www.nature.com/articles/ng.3737" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="study15" value="on">
                        <span value="15">Whole Blood - East Asian (PLoS Genetics, 2014)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 1799 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors use genome-wide data on SNPs and array-based expression measures from mononuclear cells obtained from a population-based cohort of 1,799 Bangladeshi individuals to characterize cis- and trans-eQTLs and determine if observed trans-eQTL associations are mediated by expression of transcripts in cis with the SNPs showing trans-association, using Sobel tests of mediation." aria-hidden="true"></span> 
                        <a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004818" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="study16" value="on">
                        <span value="16">Whole Blood - East Asian (PLoS One, 2014)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 298 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Using genotypes at 1.4 million SNPs and a comprehensive transcriptional profile of 15,454 coding genes and 6,113 lincRNA genes obtained from peripheral blood cells of 298 Japanese individuals, authors mapped expression quantitative trait loci (eQTLs)." aria-hidden="true"></span> 
                        <a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0100924" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">       
                        <strong>Monocytes</strong>     
                    </li>

                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study21" value="on">
                        <span value="21">Monocytes - African American (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 162 samples </span>
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>
     
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="study22" value="on">
                        <span value="22">Monocytes - East Asian (Science, 2014)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 155 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>
   
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;border-bottom:0px;">
                        <input type="checkbox" class="studyopt Option" id="study23" value="on">
                        <span value="23">Monocytes - European American (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 377 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>     
                    </li>
                    
                    <li class="list-group-item non-hipc trans" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study24" value="on">
                        <span value="24">Monocytes - Meta-analysis (Science, 2014)</span>   
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 696 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>     
                    </li>
                    
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study25" value="on">
                        <span value="25">Monocytes - European (Nature Genetics, 2012)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 288 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Using paired purified primary monocytes and B cells, authors identify new predominantly cell type–specific cis and trans expression quantitative trait loci (eQTLs), including multi-locus trans associations to LYZ and KLF4 in monocytes and B cells, respectively. " aria-hidden="true"></span>
                        <a href="http://www.nature.com/ng/journal/v44/n5/full/ng.2205.html" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>     
                    </li>
                    
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study26" value="on">
                        <span value="26">Monocytes - European American (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 432 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="To systematically investigate the impact of immune stimulation upon regulatory variant activity, we exposed primary monocytes from 432 healthy Europeans to interferon-γ (IFN-γ) or differing durations of lipopolysaccharide and mapped expression quantitative trait loci (eQTLs). More than half of cis-eQTLs identified, involving hundreds of genes and associated pathways, are detected specifically in stimulated monocytes." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/343/6175/1246949" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>       
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">   
                        <strong>CD4+ T-cells</strong>     
                    </li>

                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study31" value="on">
                        <span value="31">CD4+ T-cells - African American (Science, 2014)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 162 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>      
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study32" value="on">
                        <span value="32">CD4+ T-cells - East Asian (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 155 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>    
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study33" value="on">
                        <span value="33">CD4+ T-cells - European American (Science, 2014)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 377 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>     
                    </li>
                    
                    <li class="list-group-item non-hipc trans" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study34" value="on">
                        <span value="34">CD4+ T-cells - Meta-analysis (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 696 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Context-specific cis- and trans-eQTLs were identified, and cross-population mapping allowed, in some cases, putative functional assignment of candidate causal regulatory variants for disease-associated loci. Authors note an over-representation of T cell–specific eQTLs among susceptibility alleles for autoimmune diseases and of monocyte-specific eQTLs among Alzheimer’s and Parkinson’s disease variants. This polarization implicates specific immune cell types in these diseases and points to the need to identify the cell-autonomous effects of disease susceptibility variants." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/344/6183/519" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                        
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                       
                        <strong>B-cells</strong>                          
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study41" value="on">
                        <span value="41">B-cells - European (Nature Genetics, 2012)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 288 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Using paired purified primary monocytes and B cells, authors identify new predominantly cell type–specific cis and trans expression quantitative trait loci (eQTLs), including multi-locus trans associations to LYZ and KLF4 in monocytes and B cells, respectively. " aria-hidden="true"></span>
                        <a href="http://www.nature.com/ng/journal/v44/n5/full/ng.2205.html" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                        
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                        
                        <strong>CD16+ Neutrophils</strong>                           
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study51" value="on">
                        <span value="51">CD16+ Neutrophils - European (Nature Communications, 2015)</span> 
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 101 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors map expression quantitative trait loci (eQTL) in peripheral blood CD16+ neutrophils from 101 healthy European adults. They identify cis-eQTL for 3281 neutrophil-expressed genes including many implicated in neutrophil function, with 450 of these not previously observed in myeloid or lymphoid cells." aria-hidden="true"></span>
                        <a href="https://www.nature.com/articles/ncomms8545" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                       
                        <strong>Exposure Studies - Monocytes</strong>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study61" value="on">
                        <span value="61">Lipopolysaccharide (LPS) - 2hours - European (Science, 2014)</span>
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 432 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="To systematically investigate the impact of immune stimulation upon regulatory variant activity, we exposed primary monocytes from 432 healthy Europeans to interferon-γ (IFN-γ) or differing durations of lipopolysaccharide and mapped expression quantitative trait loci (eQTLs). More than half of cis-eQTLs identified, involving hundreds of genes and associated pathways, are detected specifically in stimulated monocytes." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/343/6175/1246949" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                          
                    </li>
                    
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study62" value="on">
                        <span value="62">Lipopolysaccharide (LPS) - 24hours - European (Science, 2014)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 432 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="To systematically investigate the impact of immune stimulation upon regulatory variant activity, we exposed primary monocytes from 432 healthy Europeans to interferon-γ (IFN-γ) or differing durations of lipopolysaccharide and mapped expression quantitative trait loci (eQTLs). More than half of cis-eQTLs identified, involving hundreds of genes and associated pathways, are detected specifically in stimulated monocytes." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/343/6175/1246949" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>
                    
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px; border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study63" value="on">
                        <span value="63">IFN-gamma - European (Science, 2014)</span>    
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 432 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="To systematically investigate the impact of immune stimulation upon regulatory variant activity, we exposed primary monocytes from 432 healthy Europeans to interferon-γ (IFN-γ) or differing durations of lipopolysaccharide and mapped expression quantitative trait loci (eQTLs). More than half of cis-eQTLs identified, involving hundreds of genes and associated pathways, are detected specifically in stimulated monocytes." aria-hidden="true"></span>
                        <a href="http://science.sciencemag.org/content/343/6175/1246949" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                    
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                       
                        <strong>Lymphoblastoid Cell Lines</strong>                         
                    </li>

                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study71" value="on">
                        <span value="71">LCL - European (Nature, 2013)</span>
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 373 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors report sequencing and deep analysis of messenger RNA and microRNA from lymphoblastoid cell lines of 462 individuals from the 1000 Genomes Project—the first uniformly processed high-throughput RNA-sequencing data from multiple human populations with high-quality genome sequences." aria-hidden="true"></span>
                        <a href="https://www.nature.com/articles/nature12531" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                          
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study72" value="on">
                        <span value="72">LCL - African (Nature, 2013)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 89 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors report sequencing and deep analysis of messenger RNA and microRNA from lymphoblastoid cell lines of 462 individuals from the 1000 Genomes Project—the first uniformly processed high-throughput RNA-sequencing data from multiple human populations with high-quality genome sequences." aria-hidden="true"></span>
                        <a href="https://www.nature.com/articles/nature12531" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>
                    
                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                       
                        <strong>Methylation</strong>                         
                    </li>

                    <li class="list-group-item non-hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study81" value="on">
                        <span value="81">methylation Quantitative Trait Locus (meQTL) - European (Nature Genetics, 2017)</span>
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 3841 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors show that disease-associated variants have widespread effects on DNA methylation in trans that likely reflect differential occupancy of trans binding sites by cis-regulated transcription factors." aria-hidden="true"></span>
                        <a href="https://www.nature.com/articles/ng.3721" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                          
                    </li>
                    
                    <li class="list-group-item non-hipc cis" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-top:0px;">
                        <input type="checkbox" class="studyopt Option" id="study82" value="on">
                        <span value="82"> expression Quantitative Trait Methylation (eQTM) - European (Nature Genetics, 2017)</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 2101 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Authors show that disease-associated variants have widespread effects on DNA methylation in trans that likely reflect differential occupancy of trans binding sites by cis-regulated transcription factors." aria-hidden="true"></span>
                        <a href="https://www.nature.com/articles/ng.3721" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span></span> </a>                         
                    </li>

                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-left:10px; border-top:0px;">                       
                        <strong>HIPC Studies</strong>                         
                    </li>

                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-left:30px; border-bottom:0px;">                        
                        <strong>Influenza Vaccination</strong>                         
                    </li>

                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" id="EmoryCheckAll" value="on">
                        <span value="200">Emory - ImmuneSpace SDY56 </span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 55 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Single center, open label study in which adult healthy volunteers with no contraindications to immunization will be vaccinated with TIV. Blood samples will be collected on Days D0 (at enrollment) and D1, D3, D7, D14, D30, D180 post vaccination to study innate and/or adaptive immunity markers. Even though influenza vaccination is considered safe, volunteers will be asked to report any local or systemic AEs from Day 0 (vaccination) to Day 7 in memory aids. Reactogenicity events will also be evaluated by injection site examination on visits at D0, D1, D3 and D7. Volunteers will be also asked to report local and systemic AEs developing the day of a blood draw." aria-hidden="true"></span>   
                        <a href="https://www.immunespace.org/project/Studies/SDY56/begin.view?" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span>    </span>  </a>                      
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt EmoryOption" id="study201" value="on">
                        <span value="201">Timepoint: Day 0</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt EmoryOption" id="study202" value="on">
                        <span value="202">Timepoint: Day 1</span>                          
                    </li>
                   
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt EmoryOption" id="study203" value="on">
                        <span value="203">Timepoint: Day 3</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt EmoryOption" id="study204" value="on">
                        <span value="204">Timepoint: Day 7</span>                         
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt EmoryOption" id="study205" value="on">
                        <span value="205">Timepoint: Day 14</span>                           
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border:0px;">
                        <input type="checkbox" id="MayoCheckAll" value="on">
                        <span value="200">Mayo - ImmuneSpace SDY67</span>  
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 120 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title="Aim 1: Characterize Immune Profiles Over Time, Aim 2: Correlate Immune Profiles with Vaccine Immunogenicity,Aim 3: Replication of Immune Profiles and Verification of Models" aria-hidden="true"></span>   
                        <a href="https://www.immunespace.org/project/Studies/SDY67/begin.view?" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span>    </span> </a>                        
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt MayoOption" value="on">
                        <span value="201">Timepoint: Day 0</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt MayoOption" value="on">
                        <span value="202">Timepoint: Day 3</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt MayoOption" value="on">
                        <span value="203">Timepoint: Day 28</span>                          
                    </li>
                   
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border:0px;">
                        <input type="checkbox" id="YaleCheckAll" value="on">
                        <span value="300">Yale - ImmuneSpace SDY400, SDY404, SDY520</span>   
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 69 samples </span> 
                        <span class="glyphicon glyphicon-info-sign" title=" Immunologic and genomic signatures of influenza vaccine response" aria-hidden="true"></span>   
                        <a href="https://www.immunespace.org/project/Studies/SDY400/begin.view?" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span>    </span>   </a>                   
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt YaleOption" value="on">
                        <span value="301">Timepoint: Day 0</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt YaleOption" value="on">
                        <span value="302">Timepoint: Day 7</span>                          
                    </li>
                    
                    <li class="list-group-item hipc" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:50px;border-bottom:0px;border-top:0px;">
                        <input type="checkbox" class="studyopt YaleOption" value="on">
                        <span value="303">Timepoint: Day 70</span>                           
                    </li> 


                    <li class="list-group-item tr-fact" style="color:black;padding-top:5px;padding-left:10px; border-top:0px;">                       
                        <strong>Transcription Factors</strong>                         
                    </li>

                    <li class="list-group-item tr-fact" style="color:black;padding-top:15px;padding-left:30px; border-bottom:0px;">                        
                        <strong>ENCODE ChIP-Seq Experiments </strong>                         
                    </li> 

                    <li class="list-group-item tr-fact" style="color:black;padding-top:5px;padding-bottom:5px;padding-left:30px;border:0px;">
                        <input type="checkbox" id="TfAll" class="studyopt Option" value="on">
                        <span value="001">Transcription Factor Binding Sites </span>   
                        <span style = "float:right;"> <span style = "color:gray; font-size:smaller;"> 144 cell types, 736 targets </span>
                        <span class="glyphicon glyphicon-info-sign" title="ChIP-Seq Transcription Factor Binding Site experiments from ENCODE" aria-hidden="true"></span>   
                        <a href="https://www.encodeproject.org/matrix/?type=Experiment&replicates.library.biosample.donor.organism.scientific_name=Homo+sapiens&assay_title=ChIP-seq&target.investigated_as=transcription+factor&assembly=hg19&award.project=ENCODE&files.file_type=bed+narrowPeak" target="_blank"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span>    </span>   </a>                   
                    </li>

                </ul>     
            </div>       
        </div>
    </div>

    
    <div class="row" id="studyEntryRow" style="border:1px solid #888888; margin-left:-5px;margin-right:-5px; margin-bottom: 20px;padding-top:10px;">
        <div class="col-md-3" style="font-size:medium;">
                <p style=""><strong> Please Select Study Type: </strong></p>               
        </div>
        
        <div class="col-md-4" style="font-size:medium;">                 
                        <label class="radio-inline"><input type="radio" onclick="selectCis()" name="studyType" id="item1" value="cis" checked>
                        cis-eQTL </label>    
                          
                        <label class="radio-inline"><input type="radio" onclick="selectTrans()" name="studyType" id="item2" value="trans">
                        trans-eQTL </label>             
        </div>
    </div>

    <div class="row" id="operationEntryRow" style="border:1px solid #888888; margin-left:-5px;margin-right:-5px; margin-bottom: 20px;padding-top:10px;">
        <div class="col-md-3" style="font-size:medium;">
                <p style=""><strong> Operation to use on Gene List: </strong></p>               
        </div>
        
        <div class="col-md-6" style="font-size:medium;">                 
                        <label class="radio-inline"><input type="radio" onclick="selectInt()" name="operationType" id="opitem1" value="intersect" >
                        Intersection </label>    
                          
                        <label class="radio-inline"><input type="radio" onclick="selectUnion()" name="operationType" id="opitem2" value="union" checked>
                        Union </label>             
        </div>
    </div>

    
    
    <div class="row" id="queryRow" style="margin-left:-5px;margin-right:-5px; padding-top:0px;">
        <div class="col-md-4" id="privDiv" style="padding-left:0px; text-align:left;">
            <label style="font-style:italic;font-size:medium;font-weight:500;"> Have private studies: </label>
        <a href="#" id="uploadStudy" class="btn btn-primary active" data-toggle="modal" data-target="#largeModal" style="width:140px; height:40px; padding:5px; margin:5px; margin-left: 0px; border: black; border-radius: 5px; color: white; font-size:medium; font-weight:400;"> Upload Study </a>
        </div>



        <div class="col-md-5" id="missingDataset" style="font-size:medium; padding-top:15px; color:red; visibility:hidden;">
                <p style=""> Please select 1 or more datasets. </p>               
        </div>

        <div class="col-md-3" id="submitButton" style="padding-left:0px; padding-right:0px; text-align:right;">
            <button onclick="submitQuery()" id="geneSearch" class="btn btn-primary active" style="width:200px; height:50px; padding:5px; margin:5px; margin-left: 0px; border: black; border-radius: 5px; color: white; font-size:large; font-weight:500;"> Submit Query </button>
        </div>
    </div>

    
    <div class="row" id="filterRow" style="margin-top: 10px; margin-left: -10px; margin-right: -10px; visibility:hidden;">

        <div class="col-md-6 filter" id="filterCol" style=" margin-left: 5px; border-style: double; border-width: 1px; border-color: #ccc; background: whitesmoke;">
           
            <label for="filterChr">SNP Chr:</label>

            <select name="sometext" id="filterChr" style="margin-top: 10px; margin-left: 10px; margin-right: 10px; font-size: 16px;width: 40px !important; min-width: 40px; max-width: 40px; size=1;">
        
                <option value="c1">1</option>
                <option value="c2">2</option>
                <option value="c3">3</option>
                <option value="c4">4</option>
                <option value="c5">5</option>
                <option value="c6">6</option>
                <option value="c7">7</option>
                <option value="c8">8</option>
                <option value="c9">9</option>
                <option value="c10">10</option>
                <option value="c11">11</option>
                <option value="c12">12</option>
                <option value="c13">13</option>
                <option value="c14">14</option>
                <option value="c15">15</option>
                <option value="c16">16</option>
                <option value="c17">17</option>
                <option value="c18">18</option>
                <option value="c19">19</option>
                <option value="c20">20</option>
                <option value="c21">21</option>
                <option value="c22">22</option>
                
            </select>

            <label for="filterChr">Position:</label>
            <input type="text" id="filterStart" name="FirstName" value="0" size="9" style="margin-left: 10px;">
            <text style="font-size: 12px; margin-top: 12px;"> - </text>
            <input type="text" id="filterEnd" name="FirstName" value="End" size="9">
        
            <button onclick="filter()" id="filter" class="btn btn-primary active" style="width:53px; height:30px; padding:5px; margin:5px; margin-left:10px;"> Filter </button> 
            
            <button onclick="unfilter()" id="unfilter" class="btn btn-primary disabled" style="width:53px; height:30px; padding:5px; margin:5px; ">  Undo </button>
        </div>

    </div> <!-- FilterRow finish -->


    <div class="row" id="plotRow" style="padding-top:0px;visibility:hidden;">
         
        <div class="col-md-6" id="plotCol" style="margin-left:90px; padding-top:10px; padding-right:0px;">
                <label style="">  Change Plot Type: </label>               
        

            <button onclick="manhattanPlot()" id="manPlot" class="btn btn-primary active" style="width:175px; height:40px; padding:5px; margin:5px; margin-left: 10px; font-size:medium; border-radius: 5px; font-weight:400;"> Manhattan Plot </button>
        </div>


        <!--div class="col-md-2" style="font-size:medium; padding-top:15px; padding-right:0px; padding-left:40px;">
                <p style=""> <strong> Change Plot Type: </strong></p>               
        </div>  

        <div class="col-md-2" style="padding-top:5px; padding-left: 0px;">
            <button onclick="manhattanPlot()" id="manPlot" class="btn btn-primary active" style="width:150px; height:40px; padding:5px; margin:5px; margin-left: 0px; border: black; border-radius: 5px; color: white; font-size:medium; font-weight:400;"> Manhattan Plot </button>
        </div-->

    </div>


    <div class="row" id="transRow" style="visibility:hidden;">
          
        <!--div class="col-md-7" id="transDiv" style="margin-left:10px; margin-top:10px; padding:5px;  ">
        </div-->

    </div>

    
    

    <div class="row" id="igvDiv" style="margin-top: -10px; margin-left: -5px; margin-right: -5px; padding:5px; visibility: hidden; border:1px solid lightgray">
    </div>


    <div class="row" id= "cisLegendRow" style = "margin-top:15px; margin-left:-5px; margin-right:-5px; border-style: solid; border-width: 1px; border-color: lightgray; visibility: hidden;">
        
        <div class="col-md-1" style="margin-top: 5px;">
            <strong> Legend: </strong>
        </div>
        
        <div class="col-md-5">
            <div class="row">
                <svg height="21" width="20">
                    <circle id="circle-leg-3" cx="10" cy="15" r="5"> </circle>
                </svg>
                <span> cis-eqtl for the queried gene common in multiple tracks </span>
            </div>
            
            <div class="row">
                <svg height="21" width="20">
                    <circle id="circle-leg-2" cx="10" cy="15" r="5"> </circle>
                </svg>
                 cis-eqtl for the queried gene in a single track
            </div>
            
            <div class="row">
                <svg height="21" width="20">
                    <circle id="circle-leg-1" cx="10" cy="15" r="5"> </circle>
                </svg>
                 cis-eqtl for a different gene in the genomic region 
            </div>
        </div>
        
        <div class="col-md-2">
        </div>
    
        <div class="col-md-4" style = "padding-left: 0px;text-align:right; margin-top:5px;">
                       
            <button onclick="saveSVG()" id="sSVG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as SVG" style="width:85px; height:30px; padding:5px; margin:5px; margin-left:10px;"> SVG  <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span></button> 
            
            <button onclick="saveCisPDF()" id="cisPDF" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PDF" style="width:85px; height:30px; padding:5px; margin:5px;"> PDF <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button> 

            <button onclick="saveCisPNG()" id="cisPNG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PNG" style="width:85px; height:30px; padding:5px; margin:5px;"> PNG <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button>
        </div>
    
    </div>

    <div class="row" id= "transLegendRow" style = "margin-top:15px; margin-left:-5px; margin-right:-5px; padding-bottom: 10px; border-style: solid; border-width: 1px; border-color: lightgray; visibility: hidden;">
        
        <div class="col-md-2" style="margin-top: 5px;">
            <strong style="font-size:14px;"> Legend: </strong>
        </div>
        
        <div class="col-md-4">
            <div class="row">
                <svg height="21" width="20">
                    <circle id="circle-leg-2" cx="10" cy="15" r="5"> </circle>
                </svg>
                <span style="font-weight:normal; font-size:14px;"> eQTL with NO GWAS hits </span>
            </div>
            
            <div class="row">
                <svg height="21" width="20">
                    <circle id="circle-leg-4" cx="10" cy="15" r="5"> </circle>
                </svg>
                 <span style="font-weight:normal; font-size:14px;"> eQTL with GWAS hit(s) </span>
            </div>
            
        </div>
        
        <!--div class="col-md-2">
        </div-->
    
        <div class="col-md-6" style = "padding-left: 0px; text-align:right; margin-top:5px; margin-left:0px; margin-right:0px;">
                       
            <button onclick="saveSVG()" id="sSVG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as SVG" style="width:65px; height:30px; padding:5px; margin:5px; margin-left:10px;"> SVG  <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span></button> 
            
            <button onclick="savePDF()" id="sPDF" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PDF" style="width:65px; height:30px; padding:5px; margin:5px;"> PDF <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button> 

            <button onclick="savePNG()" id="sPNG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PNG" style="width:65px; height:30px; padding:5px; margin:5px;"> PNG <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button>
        </div>
    
    </div>


    <div class="row" id= "controlsRow" style = "margin-top:5px; visibility:hidden;">

        <div class="col-md-3">
        </div>

        <div class="col-md-2" style = "padding-left: 0px; padding-right: 0px;">
            <button onclick="first()" id="firstB" class="btn btn-primary active" style="width:35px; height:30px; padding:5px; margin:5px; margin-left:10px;"> << </button> 
            
            <button onclick="prev()" id="prevB" class="btn btn-primary active" style="width:35px; height:30px; padding:5px; margin:5px;"> < </button> 
        </div>
        
        <div class="col-md-2">
            <p id="displayRange" style="text-align: center; font-size: 14px; margin-top:10px; font-weight:500;"> 1 - 50 </p> 
        </div>

        <div class="col-md-2" style = "padding-left: 0px; padding-right: 0px;"> 
            <button onclick="next()" id="nextB" class="btn btn-primary active" style="width:35px; height:30px; padding:5px; margin:5px;"> > </button> 
            <button onclick="last()" id="lastB" class="btn btn-primary active" style="width:35px; height:30px; padding:5px; margin:5px;"> >> </button>
        </div>
    </div>

    <div class="row" id= "saveButtonsRow" style = "margin-top:5px; visibility:hidden;">
        <div class="col-md-3" id= "saveButtonsGap">
        </div>
        
        <div class="col-md-9" style = "padding-left: 0px;">
                       
            <button onclick="saveSVG()" id="sSVG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as SVG" style="width:85px; height:30px; padding:5px; margin:5px; margin-left:10px;"> SVG  <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span></button> 
            
            <button onclick="savePDF()" id="sPDF" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PDF" style="width:85px; height:30px; padding:5px; margin:5px;"> PDF <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button> 

            <button onclick="savePNG()" id="sPNG" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Graphics as PNG" style="width:85px; height:30px; padding:5px; margin:5px;"> PNG <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> </button>
        
        </div>
    
    </div>

    <!--div class="row" id= "saveTableRow" style = "margin-top:5px; visibility:hidden;">
              
        <div class="col-md-6" style = "padding-left: 0px;">
                      
            <button onclick="saveTableCSV()" id="sTable" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Table as CSV" style="width:85px; height:30px; padding:5px; margin:5px; margin-left:20px;"> CSV  <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span></button> 

            <button onclick="saveTableSVG()" id="sTable" class="btn btn-primary active" data-toggle="tooltip" data-placement="bottom" title="Save Table as SVG" style="width:85px; height:30px; padding:5px; margin:5px; margin-left:0px;"> SVG  <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span></button>
                      
        </div>
    
    </div-->

    <select name="sometext" multiple="multiple" id="geneDataSelect" style="visibility:hidden; padding-bottom:10px; padding-top:10px; width:300px;">
        
    </select>

    <iframe id="gwasFile" src="./data/gwas.txt" style="display: none;"></iframe>


</div>  <!-- container finish-->


<div class="modal fade" id="largeModal" tabindex="-1" role="dialog" aria-labelledby="largeModal" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3 class="modal-title" id="myModalLabel">Upload Private Study</h3>
      </div>
      <div class="modal-body">
        <h4 style="text-align:center;">Upload your study and visualize results within immuneRegulation interface</h4>
      </div>

        <div class="bs-example">
    <div class="panel-group" id="accordion">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Upload cis-eQTL Data</a>
                </h4>
        </div>
        <div id="collapseOne" class="panel-collapse collapse in">
          <div class="panel-body">
            <p>Please make sure that the data file you provide is a .tsv (tab-sepaeated text) file with the following columns: </p>
            <p style="font-size:small;font-weight:bold;"> SNP Chromosome <span style="display: inline-block; width: 3ch;">&#9;</span> SNP Chromose Position <span style="display: inline-block; width: 3ch;">&#9;</span> Gene <span style="display: inline-block; width: 3ch;">&#9;</span> Gene Position <span style="display: inline-block; width: 3ch;">&#9;</span> SNP id/name <span style="display: inline-block; width: 3ch;">&#9;</span> p-value <span style="display: inline-block; width: 3ch;">&#9;</span> phenotype <span style="display: inline-block; width: 3ch;">&#9;</span> distance </p>
            <input type="file" id="uploader" />
            
            <div id="cisfileList">
                <p></p>
            </div>
          
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Upload trans-eQTL Data</a>
                </h4>
        </div>
        <div id="collapseTwo" class="panel-collapse collapse">
          <div class="panel-body">
            <p>Please make sure that the data file you provide is a .tsv (tab-sepaeated text) file with the following columns (make sure you use the same column headers listed below): </p>
            <p style="font-size:small;font-weight:bold;"> PValue <span style="display: inline-block; width: 5ch;">&#9;</span> SNPName <span style="display: inline-block; width: 5ch;">&#9;</span> SNPChr <span style="display: inline-block; width: 5ch;">&#9;</span> SNPChrPos <span style="display: inline-block; width: 5ch;">&#9;</span> Gene <span style="display: inline-block; width: 5ch;">&#9;</span> ProbeChr <span style="display: inline-block; width: 5ch;">&#9;</span> ProbeCenterChrPos </p>
            <input type="file" id="uploader2" />

            <div id="transfileList">
                <p></p>
            </div>


          </div>
        </div>
      </div>
      
      
    </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" onclick="uploadStudy()" id="saveModal" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
</div>


<nav class="navbar navbar-inverse navbar-fixed-bottom" style= "margin:5px; border: 1 px solid; border-color: gray; height: 60px;">

    <nav class="nav-upper" style = "background: #3f97ca; height: 60px; padding-top:10px;">
        <div class="container-fluid" style = "text-align:center; color:white; font-size: normal;">
            <ul class="nav navbar-upper">
                <li> ImmuneRegulation <span> | </span> Version 1.0.0 </li>
                <li> <span><a href = "http://research.mssm.edu/gumuslab/" style = "color:white; text-decoration:underline;"> Gümüş Lab </a></span> 
                    <span> | </span>Icahn School of Medicine at Mount Sinai </li>
            </ul>
        </div>
    </nav>

</nav>


<div class="container-fluid">

    <footer>
        <p></p>
    </footer>

</div>



<script type="text/javascript">

    var original, totalTrans, currenti = 0, currentj = 49;
    var geneData = [];
    var transData = [];
    var cisData = [];
    var SNP_interest;
    var SNP_hover;
    var svg;
    var wdth, hght = 410;
    var margin = {top: 30, right: 20, bottom: 30, left: 50};
    //width = 600 - margin.left - margin.right,
    //height = 270 - margin.top - margin.bottom;

    var highlightC = 0;
    var filterToggle = 0;

    var study = 0;
    var operation = 0;
    var datasetvalues = [];

    var plot = 1; //pvalue-order... 2: manhattan-plot 
    
    var reader = new FileReader();
    var userCisDataId = 0;
    var userTransDataId = 0;
    var userCisArr = [];
    var userTransArr = [];
    var userCisFilename = [];
    var userTransFilename = [];

    var viz = d3.select('#transDiv');

    
    //User File Upload
    upload_button("uploader", load_dataset);
    upload_button2("uploader2", load_dataset2);

    
    var gwasData = [];
    var gwasRead = 0;

    var tfData = [];
    var tfList = [];
    var cellList = [];
    var targetList = [];

    function LoadGWAS() {
       /* var oFrame = document.getElementById("gwasFile");
        var strRawContents = oFrame.contentWindow.document.body.childNodes[0].innerHTML.replace(/\r/g, '');
        var arrLines = strRawContents.split("\n");
        for (var i = 0; i < arrLines.length; i++) {//arrLines.forEach(function (line) {
            arrLines.split("\t");
            gwasArray.push(arrLines[i]);
            //gwasArray.push(JSON.parse(arrLines[i]));
        }
        //console.log( arrLines );
        console.log('G1: ', gwasArray[1][0]);
         */

        d3.tsv("./data/gwas.txt", function(data) {
            gwasData.push(data); 
        });

        //console.log(gwasData[0]);
    }



    function submitQuery() { 

        //addDataSets();
        // No Study (cis/trans) is selected, prompt the user to select study; default: 1 is assigned
        if(study == 0)
        {
            $("#studyEntryRow").show();
            study = 1;
            
            //return;
        }

        // Multiple Genes selected for trans study, but the operation (intersection/union) is not defined yet; default: union is assigned 
        if(study == 2 && operation == 0)
        {
            var gene = document.getElementById("geneVal").value;    
            var geneArray = gene.split(',');

            if(geneArray.length > 2)
            {
                $("#operationEntryRow").show();
                operation = 2;
                return;
            }
            
        }


        if(document.getElementById("geneSearch").innerText == "Submit Query")
        {
            datasetvalues = []; //reset datasetvalues
            addDataSets();

            //console.log("Dataset values: ", datasetvalues);


             //Transcription Factors
            if(study == 3)
            {
                var gene = document.getElementById("geneVal").value;    
                var geneArray = gene.split(',');

                if(geneArray[geneArray.length-1] == "")
                {
                    geneArray.pop();
                }

                //console.log('GeneArray: ', geneArray);

                //multiple genes are entered; display warning message
                if(geneArray.length > 1)
                {
                    var extraGeneDiv = document.getElementById("extraGene");
                    extraGeneDiv.style.visibility = "visible";
                    extraGeneDiv.innerHTML = "Please enter a single gene in the gene-box for 'TF' queries.";
                    return true;
                }

                else if(geneArray.length == 0)
                {
                    var extraGeneDiv = document.getElementById("extraGene");
                    extraGeneDiv.style.visibility = "visible";
                    extraGeneDiv.innerHTML = "Please enter a single gene in the gene-box for 'TF' queries.";
                    return true;
                }

                else
                {
                    var extraGeneDiv = document.getElementById("extraGene");
                    extraGeneDiv.style.visibility = "hidden";
                }

                datasetvalues.push(001); // reserve dataset for TFs
                displayTransFact();
            }


            if(datasetvalues.length == 0)
            {
                var missingDataDiv = document.getElementById("missingDataset");
                missingDataDiv.style.visibility = "visible";
                return true;
            }

            else if(datasetvalues.length > 0)
            {
                var missingDataDiv = document.getElementById("missingDataset");
                missingDataDiv.style.visibility = "hidden";
            } 

            //Check if cis-eQTL
            if(study == 1)
            {
                var gene = document.getElementById("geneVal").value;    
                var geneArray = gene.split(',');

                if(geneArray[geneArray.length-1] == "")
                {
                    geneArray.pop();
                }

                //console.log('GeneArray: ', geneArray);

                //multiple genes are entered; display warning message
                if(geneArray.length > 1)
                {
                    var extraGeneDiv = document.getElementById("extraGene");
                    extraGeneDiv.style.visibility = "visible";
                    extraGeneDiv.innerHTML = "Please enter a single gene in the gene-box for 'cis-eQTL' queries.";
                    return true;
                }

                else
                {
                    var extraGeneDiv = document.getElementById("extraGene");
                    extraGeneDiv.style.visibility = "hidden";
                }

            }

            if(study == 2)
            {
                var extraGeneDiv = document.getElementById("extraGene");
                extraGeneDiv.style.visibility = "hidden";
            }

            var infoRow = document.getElementById("immRegExpRow");
            infoRow.style.display = "none";

            var browseRow = document.getElementById("browseRow");
            browseRow.style.display = "none";

            var geneRow = document.getElementById("geneEntryRow");
            geneRow.style.display = "none";

            var privDiv = document.getElementById("privDiv");
            privDiv.style.display = "none";

            var missingDataDiv = document.getElementById("missingDataset");
            missingDataDiv.style.display = "none";

            var submitButtonDiv = document.getElementById("submitButton");
            submitButtonDiv.style.textAlign = "left";

            if(document.getElementById("studyEntryRow").style.display == "none")
            {
                var queryRow = document.getElementById("queryRow");
                queryRow.style.marginTop = "60px";
            }
            
            $("#operationEntryRow").hide();

            document.getElementById("geneSearch").innerText = "Modify Query";

            if(gwasRead == 0)
            {
                LoadGWAS();
                gwasRead = 1;
            }

            searchGene();
        }

        else if(document.getElementById("geneSearch").innerText == "Modify Query")
        {
            var browseRow = document.getElementById("browseRow");
            browseRow.style.display = "block";

            var geneRow = document.getElementById("geneEntryRow");
            geneRow.style.display = "block";
            geneRow.style.marginTop = "60px";

            var privDiv = document.getElementById("privDiv");
            privDiv.style.display = "block";

            var missingDataDiv = document.getElementById("missingDataset");
            missingDataDiv.style.display = "block";

            var submitButtonDiv = document.getElementById("submitButton");
            submitButtonDiv.style.textAlign = "right";

            var queryRow = document.getElementById("queryRow");
            queryRow.style.marginTop = "0px";
            document.getElementById("geneSearch").innerText = "Submit Query";

            if(study == 2)
            {
                var gene = document.getElementById("geneVal").value;    
                var geneArray = gene.split(',');

                if(geneArray.length > 2)
                {
                    $("#operationEntryRow").show();
                }
            }

        }



    }


    function filterUser()
    {
        $('.hipc').hide();
        //$('.user').show();
        
        $('.non-hipc').hide();
        $('.tr-fact').hide();
        study = 0;

        $("#studyEntryRow").hide();
        document.getElementById("item1").checked = true;

        $("#operationEntryRow").hide();

        $("#userListMain").show();
        $("#userListCis").show();
        $("#userListTrans").show();

        //$("#allStudies li:contains(User)").show();

        document.getElementById("userListMain").style.fontWeight = "bold";
        document.getElementById("userListCis").style.fontWeight = "bold";
        document.getElementById("userListTrans").style.fontWeight = "bold";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        uploadStudy();

        document.getElementById("queryType").innerText = "Cis-eQTL";
    }

    function filterCisUser()
    {
        $('.hipc').hide();
        $('.non-hipc').hide();
        $('.trans').hide();
         $('.utrans').hide();
         $('.tr-fact').hide();
        //$('.user').show();
        study = 1;

        $("#studyEntryRow").hide();
        $("#operationEntryRow").hide();

        var userListCount = document.getElementById('userListCount');
        userListCount.innerText = userCisArr.length + userTransArr.length;

        var userListCisCount = document.getElementById('userListCisCount');
        userListCisCount.innerText = userCisArr.length;

        var userListTransCount = document.getElementById('userListTransCount');
        userListTransCount.innerText = userTransArr.length;
        
        //console.log("User Study Count:::", userCisArr.length);

        //$('.user').show();
        $("#UserListTitle").show();

        for(var i = 0; i < userCisArr.length; i++)
        {
            var sid = "UserListCis" + i;
            $('#'+ sid).show();

            var spanid = 'span100' + i;
            var userCisSpan = document.getElementById(spanid);
            userCisSpan.innerText = userCisFilename[i]  + " - (Cis)";
        } 

        document.getElementById("userListMain").style.fontWeight = "bold";
        document.getElementById("userListCis").style.fontWeight = "bold";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "larger";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Cis-eQTL";
    }

    function filterTransUser()
    {
        $('.hipc').hide();
        $('.non-hipc').hide();
        $('.cis').hide();
         $('.ucis').hide();
         $('.tr-fact').hide();
        //$('.user').show();
        study = 2;

        $("#studyEntryRow").hide();

        var gene = document.getElementById("geneVal").value;    
        var geneArray = gene.split(',');

        if(geneArray.length > 2)
        {
            $("#operationEntryRow").show();
            operation = 2;
        }

        var userListCount = document.getElementById('userListCount');
        userListCount.innerText = userCisArr.length + userTransArr.length;

        var userListCisCount = document.getElementById('userListCisCount');
        userListCisCount.innerText = userCisArr.length;

        var userListTransCount = document.getElementById('userListTransCount');
        userListTransCount.innerText = userTransArr.length;
        
        //console.log("User Study Count:::", userCisArr.length);

        //$('.user').show();
        $("#UserListTitle").show();

        for(var i = 0; i < userTransArr.length; i++)
        {
            var sid = "UserListTrans" + i;
            $('#'+ sid).show();

            var spanid = 'span110' + i;
            var userTransSpan = document.getElementById(spanid);
            userTransSpan.innerText = userTransFilename[i]  + " - (Trans)";
        } 

        document.getElementById("userListMain").style.fontWeight = "bold";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "bold";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "larger";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Trans-eQTL";
        
    }

    function filterNonHIPC()
    {
        $('.hipc').hide();
        $('.user').hide();
        $('.non-hipc').show();
        $('.tr-fact').hide();
        study = 0;

        
        $("#studyEntryRow").show();
        document.getElementById("item1").checked = true;

        $("#operationEntryRow").hide();

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "bold";
        document.getElementById("listCisNonHIPC").style.fontWeight = "bold";
        document.getElementById("listTransNonHIPC").style.fontWeight = "bold";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Not Selected";
    }

    function filterHIPC()
    {
        $('.non-hipc').hide();
        $('.user').hide();
        $('.hipc').show();
        $('.tr-fact').hide();
        study = 0;

        $("#studyEntryRow").show();
        document.getElementById("item1").checked = true;

        $("#operationEntryRow").hide();

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "bold";
        document.getElementById("listCisHIPC").style.fontWeight = "bold";
        document.getElementById("listTransHIPC").style.fontWeight = "bold";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Not Selected";
    }

    function filterCisHIPC()
    {
        $('.hipc').show();
        $('.non-hipc').hide();
        $('.trans').hide();
        $('.user').hide();
        $('.tr-fact').hide();
        study = 1;

        $("#studyEntryRow").hide();
        $("#operationEntryRow").hide();

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "bold";
        document.getElementById("listCisHIPC").style.fontWeight = "bold";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "larger";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Cis-eQTL";
    }

    function filterTransHIPC()
    {
        $('.hipc').show();
        $('.non-hipc').hide();
        $('.cis').hide();
        $('.user').hide();
        $('.tr-fact').hide();
        study = 2;

        $("#studyEntryRow").hide();

        var gene = document.getElementById("geneVal").value;    
        var geneArray = gene.split(',');

        if(geneArray.length > 2)
        {
            $("#operationEntryRow").show();
            operation = 2;
        }

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "bold";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "bold";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "larger";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Trans-eQTL";
    }

    function filterCisNonHIPC()
    {
        $('.hipc').hide();
        $('.non-hipc').show();
        $('.trans').hide();
        $('.user').hide();
        $('.tr-fact').hide();
        study = 1;

        $("#studyEntryRow").hide();
        $("#operationEntryRow").hide();

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "bold";
        document.getElementById("listCisNonHIPC").style.fontWeight = "bold";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";
        document.getElementById("mainTF").style.fontWeight = "normal";
        
        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "larger";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Cis-eQTL";
    }

    function filterTransNonHIPC()
    {
        $('.hipc').hide();
        $('.non-hipc').show();
        $('.cis').hide();
        $('.user').hide();
        $('.tr-fact').hide();
        study = 2;

        $("#studyEntryRow").hide();

        var gene = document.getElementById("geneVal").value;    
        var geneArray = gene.split(',');

        if(geneArray.length > 2) {
            $("#operationEntryRow").show();
            operation = 2;
        }

        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "bold";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "bold";
        document.getElementById("mainTF").style.fontWeight = "normal";
        

        document.getElementById("mainTF").style.fontSize = "initial";
        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "larger";

        document.getElementById("queryType").innerText = "Trans-eQTL";
    }

    
    function filterTF()
    {
        $('.hipc').hide();
        $('.user').hide();
        $('.non-hipc').hide();
        
        $("#studyEntryRow").hide();
        //document.getElementById("item1").checked = true;

        $("#operationEntryRow").hide();

        $('.tr-fact').show();

        document.getElementById("mainTF").style.fontWeight = "bold";
        document.getElementById("mainTF").style.fontSize = "medium";


        document.getElementById("userListMain").style.fontWeight = "normal";
        document.getElementById("userListCis").style.fontWeight = "normal";
        document.getElementById("userListTrans").style.fontWeight = "normal";
        document.getElementById("listHIPC").style.fontWeight = "normal";
        document.getElementById("listCisHIPC").style.fontWeight = "normal";
        document.getElementById("listTransHIPC").style.fontWeight = "normal";
        document.getElementById("listNonHIPC").style.fontWeight = "normal";
        document.getElementById("listCisNonHIPC").style.fontWeight = "normal";
        document.getElementById("listTransNonHIPC").style.fontWeight = "normal";

        document.getElementById("userListMain").style.fontSize = "initial";
        document.getElementById("userListCis").style.fontSize = "initial";
        document.getElementById("userListTrans").style.fontSize = "initial";
        document.getElementById("listHIPC").style.fontSize = "initial";
        document.getElementById("listCisHIPC").style.fontSize = "initial";
        document.getElementById("listTransHIPC").style.fontSize = "initial";
        document.getElementById("listNonHIPC").style.fontSize = "initial";
        document.getElementById("listCisNonHIPC").style.fontSize = "initial";
        document.getElementById("listTransNonHIPC").style.fontSize = "initial";

        document.getElementById("queryType").innerText = "Transcription Factors";


        study = 3;

    }

    
    function displayTransFact()
    {
        var filterRow = document.getElementById("filterRow"); 
            filterRow.style.height = "0px";
            filterRow.style.visibility = "hidden";

        var filterCol = document.getElementById("filterCol"); 
            filterCol.style.height = "0px";
            filterCol.style.visibility = "hidden";

        var plotRow = document.getElementById("plotRow");
            plotRow.style.height = "0px";
            plotRow.style.visibility = "hidden";
        
        var plotCol = document.getElementById("plotCol");
            plotCol.style.height = "0px";

        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);
        
        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        var datafile = "./data/tf-meta/" + gene;

        d3.json(datafile, function(data) {
            //console.log(data[0].c);
            //console.log(data.length);
            //console.log(data);

            vizTF(data);
        });
    }

    
    function vizTF(tfData) 
    {
        tfList = [];
        cellList = [];
        targetList = [];

        $('#igvDiv').empty(); // Remove contents of igvDiv (cis eqtls)
            var igvDiv = document.getElementById("igvDiv"); 
            igvDiv.style.visibility = "hidden";

            $('#eqtlDataDiv').empty(); // Remove eqtl details 

            var transDiv = document.getElementById("transDiv");

            $('#transDiv').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details
            
            if(transDiv === null) 
                createTransDiv();


        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);
        
        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        // TF TABLE INFO...
        var tfInfoNode = document.getElementById("tfInfoDiv");
        var tfInfoInnerNode = document.getElementById("tfInfoInnerDiv");

        if(tfInfoNode === null) {
            tfInfoNode = document.createElement('div'); 
            
            tfInfoNode.id = "tfInfoDiv";
            tfInfoNode.className = "row";
            tfInfoNode.style.marginTop = "0px";
            tfInfoNode.style.marginBottom = "20px";
            tfInfoNode.style.marginLeft = "-5px";
            tfInfoNode.style.fontSize = "14px";
            tfInfoNode.style.fontWeight = "bold";
            tfInfoNode.style.visibility = "visible";

            var transDiv = document.getElementById("transDiv");
            transDiv.appendChild(tfInfoNode);
        }

        if(tfInfoInnerNode === null) {
            tfInfoInnerNode = document.createElement('div');

            tfInfoInnerNode.id = "tfInfoInnerDiv";
            tfInfoInnerNode.className = "col-md-11";
            tfInfoInnerNode.style.border = "1px solid #ccc";
            tfInfoInnerNode.style.paddingLeft = "15px";
            tfInfoInnerNode.style.paddingRight = "15px";
            tfInfoInnerNode.style.paddingTop = "5px";
            tfInfoInnerNode.style.paddingBottom = "5px";

            tfInfoNode.appendChild(tfInfoInnerNode);
        }

        tfInfoInnerNode.style.fontSize = "16px";
        tfInfoInnerNode.style.fontWeight = "bold";
        tfInfoInnerNode.innerHTML = "Target Gene: " + gene; 


        var d = document.createElement('span');
        d.className = "badge";
        //d.style.background = "steelblue";
        d.style.color = "black";
        d.style.fontSize = "15px";
        d.style.fontWeight = "normal";
        d.style.marginTop = "5px";
        d.style.marginBottom = "5px";
        d.style.marginLeft = "35px";
        var dtext = tfData.length + " total hits: ";
        var dnode = document.createTextNode(dtext);
        
        d.appendChild(dnode);
        tfInfoInnerNode.appendChild(d);

        // Append # of Cell Types
        var countCellData = _.countBy(tfData, function(obj){
            return obj.c.replace(" ", "_");
        }); 

        var countCellLen = Object.keys(countCellData).length;

        var d = document.createElement('span');
        d.className = "badge";
        d.style.background = "steelblue";
        d.style.color = "white";
        d.style.marginTop = "5px";
        d.style.marginBottom = "5px";
        d.style.marginLeft = "20px";
        var dtext = countCellLen + " cell types";
        var dnode = document.createTextNode(dtext);
        
        d.style.fontSize = "15px";
        d.style.fontWeight = "normal";
        d.appendChild(dnode);
        tfInfoInnerNode.appendChild(d);

        
        // Append # of Target Types
        var countTargetData = _.countBy(tfData, function(obj){
            return obj.t.replace(" ", "_");
        }); 

        var countTargetLen = Object.keys(countTargetData).length;

        var d = document.createElement('span');
        d.className = "badge";
        d.style.background = "steelblue";
        d.style.color = "white";
        d.style.marginTop = "5px";
        d.style.marginBottom = "5px";
        d.style.marginLeft = "30px";
        var dtext = countTargetLen + " targets";
        var dnode = document.createTextNode(dtext);
        //d.style.marginLeft = "10px";
        d.style.fontSize = "15px";
        d.style.fontWeight = "normal";
        d.appendChild(dnode);
        tfInfoInnerNode.appendChild(d);

        // TF TABLE CREATION...    
        var tfTableNode = document.getElementById("tfTableDiv");

        if(tfTableNode === null) {
            var transDiv = document.getElementById("transDiv");
            tfTableNode = document.createElement('table');

            tfTableNode.id = "tfTableDiv";
            tfTableNode.className = "display";
            tfTableNode.style.border = "1px solid #ccc";
            tfTableNode.style.marginTop = "20px";
            tfTableNode.style.marginLeft = "0px";
            tfTableNode.style.padding = "5px";
            tfTableNode.style.fontSize = "normal";
            tfTableNode.style.visibility = "visible";

            transDiv.appendChild(tfTableNode);
        }

        //Table Initialization
        var header = tfTableNode.createTHead();                    
        var tblBody = document.createElement("tbody");
        tfTableNode.appendChild(tblBody);
        //var tr = document.getElementById('rsTableDiv').tHead.children[0];
        var th = document.createElement('th');
        th.innerHTML = "Gene";
       // header.appendChild(th);
        th.innerHTML = "P-Value";


        $('#tfTableDiv').DataTable( {
                    data: tfData,

                    columns: [
                        { data: 'l', "title": 'Select Study', "type":"checkbox",
                            "render": function ( data, type, full, meta ) {
                                var text = "Select";
                                var cell;
                                var target;
                                var found = 0;

                                for(var i = 0; i < tfData.length || found == 0; i++)
                                    if(tfData[i].l == data)
                                    {
                                        cell = tfData[i].c;
                                        target = tfData[i].t;
                                        found = 1;
                                    }

                               //return '<input type="checkbox" name="id[]" value="' + $('<div/>').text(data).html() + '">';
                               

                              // return '<input type="checkbox" name="id[]"  + <a href="#" onClick="addTF(this, \''+data+'\', \''+cell+'\', \''+target+'\')">' + '</a> ';

                                return '<a href="#" onClick="addTF(this, \''+data+'\', \''+cell+'\', \''+target+'\')">'+text+'</a>';
                            } 
                        },

                        { data: 'c', "title": 'Cell Type' },

                        { data: 't', "title": 'Transcription Factor' },

                        { data: 'l', "title": 'Study Details',  
                            "render": function ( data, type, full, meta ) {
                                    var text = "View: ENCODE";
                                    var pmed = "https://www.encodeproject.org/files/" + data;
                                    var pmedlink = "<a href = " + pmed + " target=\"_blank\">" + text + "</a>";
                                    return pmedlink;
                            } 
                        }           
                    ]
                } );

            $('#example').dataTable( {
                "columnDefs": [
                    { className: "dt-body-center", "targets": [ 0, 1, 2, 3 ] }
              ]
            } );

                            
            //$('#rsTableDiv.caption').text('Table: eQTL Target Genes'); 
            $('#tfTableDiv').append('<caption> Table: Transcription Factor ChIP-Seq Studies </caption>');

            var tableDiv = document.getElementById("tfTableDiv_wrapper");
            tableDiv.style.visibility = "visible";

        
        // Create button to Visualize Tracks
        var sButton = document.getElementById("geneSearch");
        var vizClone = sButton.cloneNode(true);
        vizClone.id = "vizListButton";
        vizClone.innerHTML = "Submit";
        vizClone.onclick = new Function("vizTFTracks('13')");
        vizClone.style.visibility = "visible";
        vizClone.style.marginTop = "20px";
        vizClone.style.height = "40px";
        vizClone.style.fontSize = "medium";
        vizClone.style.fontWeight = "400";

        transDiv.appendChild(vizClone);

    }


    function addTF(obj, tf, cell, target)
    {

        if(obj.innerText == "Select")
        {
            obj.innerText = "Deselect";
            tfList.push(tf);
            cellList.push(cell);
            targetList.push(target);
        }

        else if(obj.innerText == "Deselect")
        {
            obj.innerText = "Select";
            tfList.pop(tf);
            cellList.pop(cell);
            targetList.pop(target);
        }

        // console.log('---- TF LIST:', tfList);
        // console.log('---- Cell LIST:', cellList);
        // console.log('---- Target LIST:', targetList);

        var vizButton = document.getElementById("vizListButton");

        if(tfList.length == 0)
            vizButton.innerHTML = "Submit";

        if(tfList.length > 0)
            vizButton.innerHTML = "Submit (" + tfList.length + ")" ;
    }


    function vizTFTracks()
    {
        //console.log("Tf List.........", tfList);
        var cisDiv = document.getElementById("igvDiv");
        cisDiv.style.visibility = "visible";
        cisDiv.style.marginTop = "10px";

        var genePlaceholder = document.getElementById("geneVal");
        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);
        
        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        var location = gene;

        if (location == "") {
            location = "chr1:155,160,475-155,184,282";
            genePlaceholder.placeholder = location;
        }

        else
            genePlaceholder.placeholder = "Gene";

        var div = $("#igvDiv")[0],
                options = {
                    showNavigation: true,
                    showRuler: true,
                    locus: location,
                    reference: {
                        id: "hg19"
                    },
                    
                    formats: {
                            gwasSNPS: {
                                coords: 0,
                                chr: 0,
                                start: 1,
                                end: 2,
                                fields: ["Chr", "chromStart", "chromEnd", "Strongest_SNP_risk_allele", "Disease_Phenotype", "P-value", "Odds ratio or beta", "PUBMEDID"]
                            }
                        },
                    
                    tracks: [

                            {
                                featureType: 'annotation',
                                format: 'gwasSNPS',
                                indexed: false,
                                color: 'rgb(100,200,200)',
                                displayMode: 'EXPANDED',
                                url: "./data/gwas.txt",
                                name: 'GWAS Catalog',
                                height: "150",
                                order: 9999
                            },

                            {
                                name: "Genes",
                                type: "annotation",
                                format: "gtf",
                                sourceType: "file",
                                height: "300",
                                url: "https://s3.amazonaws.com/igv.broadinstitute.org/annotations/hg19/genes/gencode.v18.annotation.sorted.gtf.gz",
                                indexURL: "https://s3.amazonaws.com/igv.broadinstitute.org/annotations/hg19/genes/gencode.v18.annotation.sorted.gtf.gz.tbi",
                                visibilityWindow: 10000000,
                                order: Number.MAX_VALUE,
                                order: 10000,
                                displayMode: "EXPANDED"
                            }
                    ]
                };

        igv.createBrowser(div, options);

        setTimeout(loadTFTracks, 1000, tfList, cellList, targetList);

    }


    function loadTFTracks(tfList, cellList, targetList)
    {

        for(var i = 0; i < tfList.length; i++)
        {

            var trackName = "Cell: " + cellList[i] + "<br/>" + "TF: " + targetList[i];
            var trackUrl = "https://www.encodeproject.org/files/" + tfList[i] + "/@@download/" + tfList[i] + ".bed.gz";

            igv.browser.loadTrack({
                                featureType: 'annotation',
                                format: 'bed',
                                indexed: false,
                                color: 'rgb(100,200,200)',
                                displayMode: 'EXPANDED',
                                url: trackUrl,
                                name: trackName,
                                height: "100"
                                });

        }
    }


    function selectCis()
    {
        $('.cis').show();
        $('.trans').hide();
        study = 1;

        $("#operationEntryRow").hide();

        document.getElementById("queryType").innerText = "Cis-eQTL";
    }

    function selectTrans()
    {
        $('.trans').show();
        $('.cis').hide();
        study = 2;

        var gene = document.getElementById("geneVal").value;    
        var geneArray = gene.split(',');

        if(geneArray.length > 2) {
            $("#operationEntryRow").show();
            operation = 2;
        }

        document.getElementById("queryType").innerText = "Trans-eQTL";
    }

    function selectInt()
    {
        operation = 1;

    }

    function selectUnion()
    {
        operation = 2;
    }


    function exampleQuery1()
    {
        filterCisNonHIPC();
        datasetvalues = [];
        deselectStudies();

        // Set datasets
        datasetvalues.push(61);
        datasetvalues.push(62);
        datasetvalues.push(63);
        document.getElementById("study61").checked = true;
        document.getElementById("study62").checked = true;
        document.getElementById("study63").checked = true;

        var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
        document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 
        document.getElementById('deselectDiv').style.visibility = "visible";

        document.getElementById("geneVal").innerHTML = "JAK2"; // Set Gene Value
        document.getElementById("geneVal").value = "JAK2";

            $('#transRow').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details 
            $('#cisLegendClone').remove();

            var filterRow = document.getElementById("filterRow"); 
            filterRow.style.height = "0px";
            filterRow.style.visibility = "hidden";

            var plotRow = document.getElementById("plotRow");
            plotRow.style.height = "0px";
            plotRow.style.visibility = "hidden";

            var manplot = document.getElementById("manPlot");
            manplot.style.height = "0px";

            var filterCol = document.getElementById("filterCol"); 
            filterCol.style.height = "0px";
            filterCol.style.visibility = "hidden";
            
            removeControls();

            var infoRow = document.getElementById("immRegExpRow");
            infoRow.style.display = "none";

            var browseRow = document.getElementById("browseRow");
            browseRow.style.display = "none";

            var geneRow = document.getElementById("geneEntryRow");
            geneRow.style.display = "none";

            var privDiv = document.getElementById("privDiv");
            privDiv.style.display = "none";

            var missingDataDiv = document.getElementById("missingDataset");
            missingDataDiv.style.display = "none";

            var submitButtonDiv = document.getElementById("submitButton");
            submitButtonDiv.style.textAlign = "left";

            if(document.getElementById("studyEntryRow").style.display == "none")
            {
                var queryRow = document.getElementById("queryRow");
                queryRow.style.marginTop = "60px";
            }
            
            $("#operationEntryRow").hide();

            document.getElementById("geneSearch").innerText = "Modify Query";

            if(gwasRead == 0)
            {
                LoadGWAS();
                gwasRead = 1;
            }
 
            drawCis(datasetvalues);
    }


    function exampleQuery2()
    {
        filterTransNonHIPC();
        datasetvalues = [];
        deselectStudies();

        // Set datasets
        datasetvalues.push(13);
        document.getElementById("westra").checked = true;

        var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
        document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 
        document.getElementById('deselectDiv').style.visibility = "visible";

        document.getElementById("geneVal").innerHTML = "IFNA1,IFNB1,IFNG,IL10,IL12A,IL12B,IL13,IL15,IL16,IL17A,IL18,IL1A,IL2,IL3,IL4,IL5,IL6,IL8,IL9,LTA,TNF,TXLNA,"; // Set Gene Value
        document.getElementById("geneVal").value = "IFNA1,IFNB1,IFNG,IL10,IL12A,IL12B,IL13,IL15,IL16,IL17A,IL18,IL1A,IL2,IL3,IL4,IL5,IL6,IL8,IL9,LTA,TNF,TXLNA,"; // Set Gene Value


        var gene = document.getElementById("geneVal").value;
        var lastChar = gene.substr(gene.length - 1);

        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        operation = 2;

            $('#igvDiv').empty(); // Remove contents of igvDiv (cis eqtls)
            var igvDiv = document.getElementById("igvDiv"); 
            igvDiv.style.visibility = "hidden";

            //$('#eqtlDataDiv').empty(); // Remove eqtl details 

            var transDiv = document.getElementById("transDiv");
            $('#transDiv').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details
            $('#cisLegendClone').remove();
            
            if(transDiv === null) 
                createTransDiv();

            
            if(operation == 2 || operation == 0)
            {
                var plotRow = document.getElementById("plotRow"); 
                plotRow.style.visibility = "visible";
                
                var plotCol = document.getElementById("plotCol");
                plotCol.style.height = "50px";

                var manplot = document.getElementById("manPlot");
                manplot.style.height = "40px";

                var filterCol = document.getElementById("filterCol"); 
                filterCol.style.height = "45px";
                filterCol.style.visibility = "visible";
            }

            var vizRow = document.getElementById("transRow"); 
            vizRow.style.visibility = "visible";

            var infoRow = document.getElementById("immRegExpRow");
            infoRow.style.display = "none";

            var browseRow = document.getElementById("browseRow");
            browseRow.style.display = "none";

            var geneRow = document.getElementById("geneEntryRow");
            geneRow.style.display = "none";

            var privDiv = document.getElementById("privDiv");
            privDiv.style.display = "none";

            var missingDataDiv = document.getElementById("missingDataset");
            missingDataDiv.style.display = "none";

            var submitButtonDiv = document.getElementById("submitButton");
            submitButtonDiv.style.textAlign = "left";

            if(document.getElementById("studyEntryRow").style.display == "none")
            {
                var queryRow = document.getElementById("queryRow");
                queryRow.style.marginTop = "60px";
            }
            
            $("#operationEntryRow").hide();

            document.getElementById("geneSearch").innerText = "Modify Query";

            if(gwasRead == 0)
            {
                LoadGWAS();
                gwasRead = 1;
            }
 
            addTrans(gene);
    }


    function exampleQuery3()
    {
        filterTF();
        datasetvalues = [];
        deselectStudies();

        // Set datasets
        datasetvalues.push(001);
        document.getElementById("TfAll").checked = true;

        var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
        document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 
        document.getElementById('deselectDiv').style.visibility = "visible";

        document.getElementById("geneVal").innerHTML = "IL17A"; // Set Gene Value
        document.getElementById("geneVal").value = "IL17A"; // Set Gene Value

            

            $('#transRow').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details 
            
            $('#igvDiv').empty(); // Remove contents of igvDiv (cis eqtls)
            var igvDiv = document.getElementById("igvDiv"); 
            igvDiv.style.visibility = "hidden";
            $('#cisLegendClone').remove();

            var filterRow = document.getElementById("filterRow"); 
            filterRow.style.height = "0px";
            filterRow.style.visibility = "hidden";

            var plotRow = document.getElementById("plotRow");
            plotRow.style.height = "0px";
            plotRow.style.visibility = "hidden";

            var manplot = document.getElementById("manPlot");
            manplot.style.height = "0px";

            var filterCol = document.getElementById("filterCol"); 
            filterCol.style.height = "0px";
            filterCol.style.visibility = "hidden";
            
            removeControls();

            var infoRow = document.getElementById("immRegExpRow");
            infoRow.style.display = "none";

            var browseRow = document.getElementById("browseRow");
            browseRow.style.display = "none";

            var geneRow = document.getElementById("geneEntryRow");
            geneRow.style.display = "none";

            var privDiv = document.getElementById("privDiv");
            privDiv.style.display = "none";

            var missingDataDiv = document.getElementById("missingDataset");
            missingDataDiv.style.display = "none";

            var submitButtonDiv = document.getElementById("submitButton");
            submitButtonDiv.style.textAlign = "left";

            if(document.getElementById("studyEntryRow").style.display == "none")
            {
                var queryRow = document.getElementById("queryRow");
                queryRow.style.marginTop = "60px";
            }
            
            $("#operationEntryRow").hide();

            document.getElementById("geneSearch").innerText = "Modify Query";

            if(gwasRead == 0)
            {
                LoadGWAS();
                gwasRead = 1;
            }
 
            displayTransFact();
    }


    function addDataSets()
    {
        if(document.getElementById("study101").checked == true){
             datasetvalues.push(101);
             study = 1;
         }

         if(document.getElementById("study111").checked == true) {
             datasetvalues.push(111);
             study = 2;
         }

         if(document.getElementById("study102").checked == true){
             datasetvalues.push(102);
             study = 1;
         }

         if(document.getElementById("study112").checked == true){
             datasetvalues.push(112);
             study = 2;
         }

         if(document.getElementById("study103").checked == true){
             datasetvalues.push(103);
             study = 1;
         }

         if(document.getElementById("study113").checked == true){
             datasetvalues.push(113);
             study = 2;
         }

        if(document.getElementById("framingham").checked == true)
             datasetvalues.push(11);

         if(document.getElementById("gtex").checked == true)
             datasetvalues.push(12);

        if(document.getElementById("westra").checked == true)
             datasetvalues.push(13);

         if(document.getElementById("study14").checked == true)
             datasetvalues.push(14);

         if(document.getElementById("study15").checked == true)
             datasetvalues.push(15);

         if(document.getElementById("study16").checked == true)
             datasetvalues.push(16);

         if(document.getElementById("study21").checked == true)
             datasetvalues.push(21);

         if(document.getElementById("study22").checked == true)
             datasetvalues.push(22);

         if(document.getElementById("study23").checked == true)
             datasetvalues.push(23);

         if(document.getElementById("study24").checked == true)
             datasetvalues.push(24);

         if(document.getElementById("study25").checked == true)
             datasetvalues.push(25);

         if(document.getElementById("study26").checked == true)
             datasetvalues.push(26);

         if(document.getElementById("study31").checked == true)
             datasetvalues.push(31);

         if(document.getElementById("study32").checked == true)
             datasetvalues.push(32);

         if(document.getElementById("study33").checked == true)
             datasetvalues.push(33);

         if(document.getElementById("study34").checked == true)
             datasetvalues.push(34);

         if(document.getElementById("study41").checked == true)
             datasetvalues.push(41);

         if(document.getElementById("study51").checked == true)
            datasetvalues.push(51);

         if(document.getElementById("study61").checked == true)
             datasetvalues.push(61);

         if(document.getElementById("study62").checked == true)
             datasetvalues.push(62);

         if(document.getElementById("study63").checked == true)
             datasetvalues.push(63);

         if(document.getElementById("study71").checked == true)
             datasetvalues.push(71);

         if(document.getElementById("study72").checked == true)
             datasetvalues.push(72);

         if(document.getElementById("study81").checked == true)
             datasetvalues.push(81);

         if(document.getElementById("study82").checked == true)
             datasetvalues.push(82);

         if(document.getElementById("study201").checked == true)
             datasetvalues.push(201);

         if(document.getElementById("study202").checked == true)
             datasetvalues.push(202);

         if(document.getElementById("study203").checked == true)
             datasetvalues.push(203);

         if(document.getElementById("study204").checked == true)
             datasetvalues.push(204);

         if(document.getElementById("study205").checked == true)
             datasetvalues.push(205);
    }

    
    function deselectStudies() {
        var allcheckboxes = document.querySelectorAll('input.studyopt');
            
            for(var i = 0; i < allcheckboxes.length; i++)
                allcheckboxes[i].checked = false;

        var emorycheckall = document.getElementById('EmoryCheckAll');
        emorycheckall.checked = false;

        var mayocheckall = document.getElementById('MayoCheckAll');
        mayocheckall.checked = false;

        var yalecheckall = document.getElementById('YaleCheckAll');
        yalecheckall.checked = false;

        //Update Study Count
        var allcheckedcount = document.querySelectorAll('input.studyopt:checked').length;
        document.getElementById('studyCountText').innerText = allcheckedcount + " studies selected"; 

        document.getElementById('deselectDiv').style.visibility = "hidden";   
    
    }


    function uploadStudy()
    {
        $("#userListMain").show();
        $("#userListCis").show();
        $("#userListTrans").show();

        //$("#allStudies li:contains(User)").show();

        var userListCount = document.getElementById('userListCount');
        userListCount.innerText = userCisArr.length + userTransArr.length;

        var userListCisCount = document.getElementById('userListCisCount');
        userListCisCount.innerText = userCisArr.length;

        var userListTransCount = document.getElementById('userListTransCount');
        userListTransCount.innerText = userTransArr.length;
        
        //console.log("User Study Count:::", userCisArr.length);

        //$('.user').show();
        $("#UserListTitle").show();

        for(var i = 0; i < userTransArr.length; i++)
        {
            var sid = "UserListTrans" + i;
            $('#'+ sid).show();

            var spanid = 'span110' + i;
            var userTransSpan = document.getElementById(spanid);
            userTransSpan.innerText = userTransFilename[i] + " - (Trans)";
        } 

        for(var i = 0; i < userCisArr.length; i++)
        {
            var sid = "UserListCis" + i;
            $('#'+ sid).show();

            var spanid = 'span100' + i;
            var userCisSpan = document.getElementById(spanid);
            userCisSpan.innerText = userCisFilename[i] + " - (Cis)";
        } 
        
        //$("#userListCis1").show();
        

        //$("#userListMain").find("span").text("dddd");
    }


    function loadFile()
    {
       
        var file = document.querySelector('input[type=file]').files[0];
        var ddd = d3.tsv.parse(file)
        create_table(data);

       /* var file = document.querySelector('input[type=file]').files[0];      
        

        if (file) {
            reader.readAsText(file);
        }

        reader.addEventListener("onloadend", parseFile, false); */
        /*
        if (!files.length) {
            console.log("No files selected");
            return;
        } 
        else 
        {
            fileList.innerHTML = "";
            var list = document.createElement("ul");
            fileList.appendChild(list);
            
            for (var i = 0; i < files.length; i++) {
                var li = document.createElement("li");
                list.appendChild(li);
              
                var img = document.createElement("img");
                img.src = window.URL.createObjectURL(files[i]);
                img.height = 60;
              
                img.onload = function() {
                    window.URL.revokeObjectURL(this.src);
                }
              
                li.appendChild(img);
                var info = document.createElement("span");
                info.innerHTML = files[i].name + ": " + files[i].size + " bytes";
                li.appendChild(info);
            }
        }
        */
        
             
    }


    function parseFile(){
        //var doesColumnExist = false;
          d3.text(reader.result, function(text) {
            userArr[userDataId] = d3.tsv.parseRows(text).map(function(row) {
                return row.map(function(value) {
                    return +value;
                });
                return userArr[userDataId];
            });
            
            userDataId++;

            //statistics(dataArr, foldername, toothid);
        });

          //console.log("User Data ID: ", userDataId);
          
    }

    
    function searchGene() {
        geneData = []; //reset geneData
        currenti = 0;
        currentj = 49;
        SNP_interest = "";
        datasetvalues = []; //reset datasetvalues

        addDataSets();

        var gene = document.getElementById("geneVal").value;
        var lastChar = gene.substr(gene.length - 1);

        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);
        
        var geneArray = gene.split(',');

        $('#geneSetDiv').empty();

        //Remove cis Legend Clone Div
        $('#cisLegendClone').remove();

        //console.log("Study: ", study);
        //console.log("Dataset: ", dataset);

        //Cis-eQTL
        if(study == 1) {
            $('#transRow').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details 
            //$('#plotRow').empty(); 

            var filterRow = document.getElementById("filterRow"); 
            filterRow.style.height = "0px";
            filterRow.style.visibility = "hidden";

            /*var transRow = document.getElementById("transRow");
            transRow.style.height = "30px";
            transRow.style.visibility = "hidden"; */

            var plotRow = document.getElementById("plotRow");
            plotRow.style.height = "0px";
            plotRow.style.visibility = "hidden";

            var manplot = document.getElementById("manPlot");
            manplot.style.height = "0px";

            var filterCol = document.getElementById("filterCol"); 
            filterCol.style.height = "0px";
            filterCol.style.visibility = "hidden";
            
            removeControls();
 
            drawCis(datasetvalues);
        }
                
        // Trans-eQTL
        else if (study == 2) 
        { 
            $('#igvDiv').empty(); // Remove contents of igvDiv (cis eqtls)
            var igvDiv = document.getElementById("igvDiv"); 
            igvDiv.style.visibility = "hidden";

            //$('#eqtlDataDiv').empty(); // Remove eqtl details 

            var transDiv = document.getElementById("transDiv");
            $('#transDiv').empty(); // Remove contents of transDiv (trans eqtls)
            $('#geneDataDiv').remove(); //remove Gene Data
            $('#eqtlDataDiv').remove(); // Remove eqtl details
            
            if(transDiv === null) 
                createTransDiv();

            if(gene == "")
                gene = "all";
            
            //console.log("Gene: ", gene);

            if(operation == 2 || operation == 0)
            {
                var plotRow = document.getElementById("plotRow"); 
                plotRow.style.visibility = "visible";
                
                var plotCol = document.getElementById("plotCol");
                plotCol.style.height = "50px";

                var manplot = document.getElementById("manPlot");
                manplot.style.height = "40px";

                var filterCol = document.getElementById("filterCol"); 
                filterCol.style.height = "45px";
                filterCol.style.visibility = "visible";
            }

            if(operation == 1)
            {

                var filterRow = document.getElementById("filterRow"); 
                    filterRow.style.height = "0px";
                    filterRow.style.visibility = "hidden";

                var filterCol = document.getElementById("filterCol"); 
                    filterCol.style.height = "0px";
                    filterCol.style.visibility = "hidden";

                var plotRow = document.getElementById("plotRow");
                    plotRow.style.height = "0px";
                    plotRow.style.visibility = "hidden";

                $('#transDiv').empty(); // Remove contents of transDiv (trans eqtls)
                $('#geneDataDiv').remove(); //remove Gene Data
                $('#eqtlDataDiv').remove(); // Remove eqtl details
            }

            var vizRow = document.getElementById("transRow"); 
            vizRow.style.visibility = "visible";

            //Add All Trans-eqtl Results
            addTrans(gene);
           
            //dataCheck(gene, transData);
        }

        //datasetvalues = [];
    }



    function createTransDiv() {      
        var vizRow = document.getElementById("transRow");
        var transDivNode = document.createElement('div');

        transDivNode.id = "transDiv";
        transDivNode.className = "col-md-6";
        //transDivNode.style.border = "1px solid #ccc";
        transDivNode.style.padding = "5px";
        transDivNode.style.marginLeft = "10px";
        transDivNode.style.marginTop = "10px";
        //transDivNode.style.paddingBottom = "5px";

        vizRow.appendChild(transDivNode);
    }


    function isInArray(value, array) {
        return array.indexOf(value) > -1;
    }


    function addTrans(gene) {
        var totalTrans = 0;
        transData = [];
        var toggle11 = 0, toggle13 = 0, toggle15 = 0, toggle16 = 0, toggle24 = 0, toggle25 = 0, toggle26 = 0, toggle34 = 0, toggle41 = 0, toggle51 = 0, toggle61 = 0, toggle62 = 0, toggle63 = 0, toggle81 = 0, toggle111 = 0, toggle112 = 0, toggle113 = 0, toggle201 = 0, toggle202 = 0, toggle203 = 0, toggle204 = 0, toggle205 = 0;
        //var backData, backData2;
        
        //var gene = document.getElementById("geneVal").value;
        var geneArray = gene.trim().split(/\s*,\s*/);
        var geneSetData = [];

        //console.log("Dataset values: ", datasetvalues);
        //console.log("geneArray: ", geneArray);


        for (var i = 0; i < datasetvalues.length; i++) 
        {
            if(datasetvalues[i] == 11)
                toggle11 = 1;
            else if(datasetvalues[i] == 13)
                toggle13 = 1;
            else if(datasetvalues[i] == 15)
                toggle15 = 1;
            else if(datasetvalues[i] == 16)
                toggle16 = 1;
            else if(datasetvalues[i] == 24)
                toggle24 = 1;
            else if(datasetvalues[i] == 25)
                toggle25 = 1;
            else if(datasetvalues[i] == 26)
                toggle26 = 1;
            else if(datasetvalues[i] == 34)
                toggle34 = 1;
            else if(datasetvalues[i] == 41)
                toggle41 = 1;
            else if(datasetvalues[i] == 51)
                toggle51 = 1;
            else if(datasetvalues[i] == 61)
                toggle61 = 1;
            else if(datasetvalues[i] == 62)
                toggle62 = 1;
            else if(datasetvalues[i] == 63)
                toggle63 = 1;
            else if(datasetvalues[i] == 81)
                toggle81 = 1;
            else if(datasetvalues[i] == 111)
                toggle111 = 1;
            else if(datasetvalues[i] == 112)
                toggle112 = 1;
            else if(datasetvalues[i] == 113)
                toggle113 = 1;
            else if(datasetvalues[i] == 201)
                toggle201 = 1;
            else if(datasetvalues[i] == 202)
                toggle202 = 1;
            else if(datasetvalues[i] == 203)
                toggle203 = 1;
            else if(datasetvalues[i] == 204)
                toggle204 = 1;
            else if(datasetvalues[i] == 205)
                toggle205 = 1;
        }
        
        if(toggle11 == 1) 
        {
            d3.tsv("./data/westra-trans.txt", function(rows13) { 
                d3.tsv("./data/pierce/pierce-t2.txt", function(rows15) {
                    d3.tsv("./data/yamada/yamada-trans.txt", function(rows16) {
                        d3.tsv("./data/jager/monocytes-trans.txt", function(rows24) {
                            d3.tsv("./data/fairfax/mono-trans.txt", function(rows25) {
                                d3.tsv("./data/fairfax/mono-trans-naive.txt", function(rows26) {
                                    d3.tsv("./data/jager/cd4T-trans.txt", function(rows34) {
                                        d3.tsv("./data/fairfax/bcell-trans.txt", function(rows41) {
                                            d3.tsv("./data/fairfax/neutrophils-trans-final.txt", function(rows51) {
                                                d3.tsv("./data/fairfax/mono-trans-lps2.txt", function(rows61) {
                                                    d3.tsv("./data/fairfax/mono-trans-lps24.txt", function(rows62) {
                                                        d3.tsv("./data/fairfax/mono-trans-ifn.txt", function(rows63) {
                                                            d3.tsv("./data/heijmans/trans-meqtl.txt", function(rows81) {
                                                                d3.tsv("./data/emory/trans-day0.txt", function(rows201) {
                                                                    d3.tsv("./data/emory/trans-day1.txt", function(rows202) {
                                                                        d3.tsv("./data/emory/trans-day3.txt", function(rows203) {
                                                                            d3.tsv("./data/emory/trans-day7.txt", function(rows204) {
                                                                                d3.tsv("./data/emory/trans-day14.txt", function(rows205) {

                                                                                    d3.tsv("./data/fram-trans-final.txt", function(rows11) {


                                                                                        if(toggle11 == 1)
                                                                                            transData.push(rows11);

                                                                                        if(toggle13 == 1)
                                                                                            transData.push(rows13);

                                                                                        if(toggle15 == 1)
                                                                                            transData.push(rows15);

                                                                                        if(toggle16 == 1)
                                                                                            transData.push(rows16);
                                                                                        
                                                                                        if(toggle24 == 1)
                                                                                            transData.push(rows24);
                                                                                            
                                                                                        if(toggle25 == 1)
                                                                                            transData.push(rows25);
                                                                                            
                                                                                        if(toggle26 == 1)
                                                                                            transData.push(rows26);

                                                                                        if(toggle34 == 1)
                                                                                            transData.push(rows34);
                                                                                        
                                                                                        if(toggle41 == 1)
                                                                                            transData.push(rows41);
                                                                                            
                                                                                        if(toggle51 == 1)
                                                                                            transData.push(rows51);
                                                                                            
                                                                                        if(toggle61 == 1)
                                                                                            transData.push(rows61);

                                                                                        if(toggle62 == 1)
                                                                                            transData.push(rows62);
                                                                                        
                                                                                        if(toggle63 == 1)
                                                                                            transData.push(rows63);

                                                                                        if(toggle81 == 1)
                                                                                            transData.push(rows81);

                                                                                        if(toggle201 == 1)
                                                                                            transData.push(rows201);

                                                                                        if(toggle202 == 1)
                                                                                            transData.push(rows202);

                                                                                        if(toggle203 == 1)
                                                                                            transData.push(rows203);

                                                                                        if(toggle204 == 1)
                                                                                            transData.push(rows204);

                                                                                        if(toggle205 == 1)
                                                                                            transData.push(rows205);

                                                                                        if(toggle111 == 1)
                                                                                            transData.push(userTransArr[0]);

                                                                                        if(toggle112 == 1)
                                                                                            transData.push(userTransArr[1]);

                                                                                        if(toggle113 == 1)
                                                                                            transData.push(userTransArr[2]);

                                                                                        //console.log("TRANS DATA: ", transData);
                                                                                        //console.log("Total trans: ", transData.length);

                                                                                        if(geneArray.length > 1)
                                                                                        {
                                                                                            for(var i = 0; i < transData.length; i++)
                                                                                                for(var j = 0; j < transData[i].length; j++)
                                                                                                    if( isInArray(transData[i][j].Gene, geneArray) )
                                                                                                        geneSetData.push(transData[i][j]);  
                                                                                            
                                                                                            //console.log("Gene Set Data: ", geneSetData);
                                                                                            calcCommonTrans(geneSetData);
                                                                                        }

                                                                                        else
                                                                                            dataCheck(transData, gene, geneArray);
                                                                                    });
                                                                                });
                                                                            });
                                                                        });
                                                                    });
                                                                });
                                                            });
                                                        });
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });

        }

        
        else
        {
            d3.tsv("./data/westra-trans.txt", function(rows13) { 
                d3.tsv("./data/pierce/pierce-t2.txt", function(rows15) {
                    d3.tsv("./data/yamada/yamada-trans.txt", function(rows16) {
                        d3.tsv("./data/jager/monocytes-trans.txt", function(rows24) {
                            d3.tsv("./data/fairfax/mono-trans.txt", function(rows25) {
                                d3.tsv("./data/fairfax/mono-trans-naive.txt", function(rows26) {
                                    d3.tsv("./data/jager/cd4T-trans.txt", function(rows34) {
                                        d3.tsv("./data/fairfax/bcell-trans.txt", function(rows41) {
                                            d3.tsv("./data/fairfax/neutrophils-trans-final.txt", function(rows51) {
                                                d3.tsv("./data/fairfax/mono-trans-lps2.txt", function(rows61) {
                                                    d3.tsv("./data/fairfax/mono-trans-lps24.txt", function(rows62) {
                                                        d3.tsv("./data/fairfax/mono-trans-ifn.txt", function(rows63) {
                                                            d3.tsv("./data/heijmans/trans-meqtl.txt", function(rows81) {
                                                                d3.tsv("./data/emory/trans-day0.txt", function(rows201) {
                                                                    d3.tsv("./data/emory/trans-day1.txt", function(rows202) {
                                                                        d3.tsv("./data/emory/trans-day3.txt", function(rows203) {
                                                                            d3.tsv("./data/emory/trans-day7.txt", function(rows204) {
                                                                                d3.tsv("./data/emory/trans-day14.txt", function(rows205) {

                                                                                    if(toggle13 == 1)
                                                                                        transData.push(rows13);
                                                                                    
                                                                                    if(toggle15 == 1)
                                                                                        transData.push(rows15);

                                                                                    if(toggle16 == 1)
                                                                                        transData.push(rows16);

                                                                                    if(toggle24 == 1)
                                                                                        transData.push(rows24);
                                                                                        
                                                                                    if(toggle25 == 1)
                                                                                        transData.push(rows25);
                                                                                        
                                                                                    if(toggle26 == 1)
                                                                                        transData.push(rows26);

                                                                                    if(toggle34 == 1)
                                                                                        transData.push(rows34);
                                                                                    
                                                                                    if(toggle41 == 1)
                                                                                        transData.push(rows41);
                                                                                        
                                                                                    if(toggle51 == 1)
                                                                                        transData.push(rows51);
                                                                                        
                                                                                    if(toggle61 == 1)
                                                                                        transData.push(rows61);

                                                                                    if(toggle62 == 1)
                                                                                        transData.push(rows62);
                                                                                    
                                                                                    if(toggle63 == 1)
                                                                                        transData.push(rows63);

                                                                                    if(toggle81 == 1)
                                                                                        transData.push(rows81);

                                                                                    if(toggle201 == 1)
                                                                                        transData.push(rows201);

                                                                                    if(toggle202 == 1)
                                                                                        transData.push(rows202);

                                                                                    if(toggle203 == 1)
                                                                                        transData.push(rows203);

                                                                                    if(toggle204 == 1)
                                                                                        transData.push(rows204);

                                                                                    if(toggle205 == 1)
                                                                                        transData.push(rows205);

                                                                                    if(toggle111 == 1)
                                                                                        transData.push(userTransArr[0]);

                                                                                    if(toggle112 == 1)
                                                                                        transData.push(userTransArr[1]);

                                                                                    if(toggle113 == 1)
                                                                                        transData.push(userTransArr[2]);

                                                                                    //console.log("TRANS DATA: ", transData);
                                                                                    //console.log("Total trans: ", transData.length);
                                                                                    
                                                                                    if(geneArray.length > 1)
                                                                                    {
                                                                                        
                                                                                        //Union operation
                                                                                        if(operation == 2)                                                  
                                                                                            dataCheck(transData, gene, geneArray);

                                                                                        
                                                                                        // Intersection Operation
                                                                                        else 
                                                                                        {
                                                                                            for(var i = 0; i < transData.length; i++)
                                                                                                for(var j = 0; j < transData[i].length; j++)
                                                                                                    if( isInArray(transData[i][j].Gene, geneArray) )
                                                                                                        geneSetData.push(transData[i][j]);  
                                                                                            
                                                                                            //console.log("Gene Set Data: ", geneSetData);
                                                                                            calcCommonTrans(geneSetData);
                                                                                        }
                                                                                    }

                                                                                    else
                                                                                        dataCheck(transData, gene, geneArray);

                                                                            });
                                                                        });
                                                                    });
                                                                });
                                                            });
                                                        });
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });

        }

    }


    function addG() {
        var btn = document.getElementById("wBtn");
        btn.className = "btn btn-primary active btn-block"; 
        btn.style.background = "lightgray";

        btn = document.getElementById("gBtn");

        btn.className = "btn btn-primary disabled btn-block"; 
        btn.style.background = "gray";

        d3.select("svg").remove();
    }
    

    function dataCheck(data, gene, geneArray) {
        //var sliced = data.slice(i,j);
        geneData = [];

        //IF no gene is specified, show all data
        if(gene == "all") {

            for(var i = 0; i < data.length; i++)
                for(var j = 0; j < data[i].length; j++)
                    geneData.push(data[i][j]);

            geneData.sort(function(a, b){
                return a.PValue-b.PValue;
            });

            dataSlicer(geneData, 0, 49);
            currenti = 0;
            currentj = 49;
            updateRange(currenti, currentj);
        }

        else {
            for(var i = 0; i < data.length; i++)
                for(var j = 0; j < data[i].length; j++)
                    if( isInArray(data[i][j].Gene, geneArray) )
                        geneData.push(data[i][j]);
                    //if(data[i][j].Gene == gene)
                        //geneData.push(data[i][j]);

            geneData.sort(function(a, b){
                return a.PValue-b.PValue;
            });

            var dataSize = geneData.length;
            //console.log("geneData length: ", dataSize);
            
            var vizDiv = document.getElementById("transDiv");

            if(dataSize == 0) {              
                vizDiv.style.fontSize = "16px";
                vizDiv.style.fontWeight = "bold";
                vizDiv.style.textAlign = "center";
                vizDiv.style.border = "1px solid black";
                vizDiv.innerHTML = "NO RESULTS FOUND...";
                removeControls();
                removefilterControl();
                $('#geneDataDiv').empty(); //remove Gene Data
                
                var plotRow = document.getElementById("plotRow");
                plotRow.style.height = "0px";
                plotRow.style.visibility = "hidden";
            }

            else {
                $('#transDiv').empty();
                //vizDiv.innerHTML = "";
                vizDiv.style.border = "";
                vizDiv.style.textAlign = "left";
                
                removeControls();

                           
                addGeneData(gene, geneData, dataSize);
                addfilterControl();
                drawTrans(geneData, geneData[0].PValue, dataSize);
                
                if(dataSize > 50) {
                    addControls();
                    //updateRange(0, 49);
                    addTransLegends();
                    //addSaveButtons(true);
                }
                
                else
                    addTransLegends();
                    //addSaveButtons(false);
            }
         
        }
        //console.log("geneData[0]: ", geneData[0]);          
    }


    function dataSlicer(data, i, j) {
        var sliced = data.slice(i,j);
        //console.log("Drawing... i: ",i, " j: ", j);
        
        $('#transDiv').empty();
        var vizDiv = document.getElementById("transDiv");
        vizDiv.style.border = "";
        
        addGeneData("all", geneData, data.length);
        addfilterControl();

        drawTrans(sliced, data[0].PValue, sliced.length);  
        addControls();
        addTransLegends();
        //addSaveButtons(true);
    }


    function addControls() {
        var controlsRow = document.getElementById("controlsRow"); 
        var vizDiv = document.getElementById("transDiv");
        
        var ControlClone = controlsRow.cloneNode(true);

        vizDiv.appendChild(ControlClone);
        ControlClone.style.visibility = "visible";
    }

    
    function addSaveButtons(addGap) {
        var saveButtonsRow = document.getElementById("saveButtonsRow"); 
        var vizDiv = document.getElementById("transDiv");
        
        var saveButtonsClone = saveButtonsRow.cloneNode(true);

        vizDiv.appendChild(saveButtonsClone);
        
       /* if(addGap == false)
        {
            var saveButtonsGap = document.getElementById("saveButtonsGap");
            saveButtonsGap.style.display = "none";
        } */

        saveButtonsClone.style.visibility = "visible";

    }


    function addLegends() {
        var legendRow = document.getElementById("cisLegendRow"); 
        var containerDiv = document.getElementById("igvDiv");
        
        var legendClone = legendRow.cloneNode(true);
        legendClone.id = "cisLegendClone";

        containerDiv.parentNode.insertBefore(legendClone, containerDiv.nextSibling);
        //containerDiv.appendChild(legendClone);
        legendClone.style.visibility = "visible";
    }


    function addTransLegends() {
        var legendRow = document.getElementById("transLegendRow"); 
        var transDiv = document.getElementById("transDiv");
        
        var legendClone = legendRow.cloneNode(true);
        legendClone.id = "transLegendClone";

        transDiv.appendChild(legendClone);
        //containerDiv.parentNode.insertBefore(legendClone, containerDiv.nextSibling);
        //containerDiv.appendChild(legendClone);
        legendClone.style.visibility = "visible";
    }


    function removeControls() {
        var controlsRow = document.getElementById("controlsRow"); 
        controlsRow.style.visibility = "hidden"; 
    }

    
    function addfilterControl() {
        var filterRow = document.getElementById("filterRow"); 
        filterRow.style.visibility = "visible";

        var filterCol = document.getElementById("filterCol"); 
        filterCol.style.visibility = "visible";
        filterCol.style.height = "45x";
    }

    function removefilterControl() {
        var filterRow = document.getElementById("filterRow"); 
        filterRow.style.visibility = "hidden";

        var filterCol = document.getElementById("filterCol"); 
        filterCol.style.visibility = "hidden";
        filterCol.style.height = "0px";
    }

    function updateRange(currenti, currentj) {
        var RangeNode = document.getElementById("displayRange");
        var content = "" + (currenti+1) + " - " + (currentj+1);
        RangeNode.innerHTML = content;
    }

    function first() {  
        currenti = 0;
        currentj = 49;

        dataSlicer(geneData, currenti, currentj);
        updateRange(currenti, currentj);
    }

    function last() {
        var len = geneData.length;

        currenti = (parseInt(len / 50) * 50);
        currentj = currenti + 49;
        
        dataSlicer(geneData, currenti, currentj);
        updateRange(currenti, currentj);
    }

    function next() {
        currenti = currentj + 1;
        currentj = currentj + 50;
        
        dataSlicer(geneData, currenti, currentj);
        updateRange(currenti, currentj);
    }

    function prev() {
        if (currenti == 0)
            return;
        currenti = currenti - 50;
        currentj = currentj - 50;
        
        dataSlicer(geneData, currenti, currentj);
        updateRange(currenti, currentj);
    }


    function saveSVG() {
        var tmp = document.getElementById("transDiv");
        var svg = tmp.getElementsByTagName("svg")[0];

        var svgData = svg.outerHTML;
        var svgBlob = new Blob([svgData], {type:"image/svg+xml;charset=utf-8"});
        var svgUrl = URL.createObjectURL(svgBlob);
        var downloadLink = document.createElement("a");
        downloadLink.href = svgUrl;
        downloadLink.download = "transEQTLs.svg";
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
    }


    function savePNG(){
        var svg = d3.select("svg");
        var w = parseInt(svg.style("width"), 10);
        var h = parseInt(svg.style("height"), 10);

        var svgString = getSVGString(svg.node());
        svgString2Image( svgString, 2 * w, 2 * h, 'png', save ); // passes Blob and filesize String to the callback

        function save( dataBlob, filesize ){
            saveAs( dataBlob, 'transEQTLs.png' ); // FileSaver.js function
        }
        
    }


    function savePDF(){
       // svg_to_pdf(document.querySelector("svg"), function (pdf) {
       //         download_pdf('SVG.pdf', pdf.output('dataurlstring'));
       //     });


        const svgElement = document.getElementById('trans-svg');
        const width = 800, height = 600;

        // create a new jsPDF instance
        const pdf = new jsPDF2('l', 'pt', [width, height]);

        // render the svg element
        svg2pdf(svgElement, pdf, {
            xOffset: 25,
            yOffset: 20,
            scale: 1
        });

        // get the data URI
        const uri = pdf.output('datauristring');

        // or simply safe the created pdf
        pdf.save('transEQTLs.pdf');
    }


    function saveCisPNG() {

        html2canvas($("#igvDiv"), {
            onrendered: function(canvas) {
                theCanvas = canvas;


                canvas.toBlob(function(blob) {
                    saveAs(blob, "cisEQTLs.png"); 
                });
            }
        });

    }


    function saveCisPDF() {

        html2canvas($("#igvDiv"), {
            onrendered: function(canvas) {
                $('#container').html("");
                $('#container').append(canvas);

                var imgData = canvas.toDataURL("image/png", 1.0);
                var pdf = new jsPDF();

                pdf.addImage(imgData, 0, 0, 200, 200, 0, 0);

                pdf.save('cisEQTLs.pdf');
            }
        });

    }
    


    function addGeneData(gene, geneData, dataSize) {
        var geneNode = document.getElementById("geneDataDiv");
        var geneInnerNode = document.getElementById("geneDataInnerDiv");

        if(geneNode === null) {
            geneNode = document.createElement('div'); 
            
            geneNode.id = "geneDataDiv";
            geneNode.className = "row";
            geneNode.style.marginTop = "20px";
            geneNode.style.marginLeft = "-5px";
            geneNode.style.fontSize = "14px";
            geneNode.style.fontWeight = "bold";

            $("#queryRow").after(geneNode);
        }

        if(geneInnerNode === null) {
            geneInnerNode = document.createElement('div');

            geneInnerNode.id = "geneDataInnerDiv";
            geneInnerNode.className = "col-md-6";
            geneInnerNode.style.border = "1px solid #ccc";
            geneInnerNode.style.paddingLeft = "15px";
            geneInnerNode.style.paddingRight = "15px";
            geneInnerNode.style.paddingTop = "5px";
            geneInnerNode.style.paddingBottom = "5px";

            geneNode.appendChild(geneInnerNode);
        }

        geneInnerNode.innerHTML = " "
        
        if(gene == "all")
            htmlcontent = "Gene(s): ALL";

        //Append Data Size
        var d = document.createElement('span');
        d.className = "badge";
        d.style.background = "steelblue";
        d.style.color = "white";
        var dtext = dataSize + " trans-eQTLs";
        var dnode = document.createTextNode(dtext);
        //d.style.marginLeft = "10px";
        d.style.fontSize = "16px";
        d.style.fontWeight = "normal";
        d.appendChild(dnode);
        geneInnerNode.appendChild(d);

        //Append Gene List
        var p = document.createElement('span');
        var ptext = document.createTextNode("Selected Genes:");
        p.style.marginLeft = "35px";
        p.style.fontSize = "14px";
        p.style.verticalAlign = "middle";
        p.appendChild(ptext);
        geneInnerNode.appendChild(p);

        var genedataselect = document.getElementById("geneDataSelect");
        var genedataselectClone = genedataselect.cloneNode(true);

        //add each Gene 
        var geneArray = gene.trim().split(/\s*,\s*/);

        for(var i = 0; i < geneArray.length; i++)
        {
            var opt1 = document.createElement("option");
            
            //Calculate the count value
            var dcount = 0;
            for(var j = 0; j < geneData.length; j++)
            {
                if(geneData[j].Gene === geneArray[i])
                    dcount++
            }

            opt1.className = "filterGene";
            opt1.text = geneArray[i] + " (" + dcount + ")"; 
            opt1.id = "geneD" + i;
            opt1.selected = true;
            genedataselectClone.add(opt1);

        /*    var p = document.createElement('span');
            var countText = " (" + dcount + ")";
            var ptext = document.createTextNode(countText);
            //p.style.marginLeft = "35px";
            //p.style.fontSize = "14px";
            //p.style.verticalAlign = "middle";
            p.appendChild(ptext);
            opt1.appendChild(p); */
        } 
        


        genedataselectClone.style.visibility = "visible";
        geneInnerNode.appendChild(genedataselectClone);
        $('#geneDataSelect').multiselect({
                enableFiltering: true,
                includeSelectAllOption: true,
                buttonText: function(options, select) {
                    return 'Filter Gene List';
                },
                maxHeight: 300,
                buttonWidth: '240px'
        }); 

        //Filter trans-eQTLs based on filter selection 
        var filtercheckboxes = document.querySelectorAll("label.checkbox > input");
        
        for(var i = 0; i < filtercheckboxes.length; i++) {

            filtercheckboxes[i].onclick = function() {

                var allcircles = document.querySelectorAll('circle.circle');
                
                if(this.checked === false)
                {
                    for (var j = 0; j < allcircles.length; j++)
                    {
                        if(allcircles[j].__data__.Gene === this.value.split(' ')[0] || this.value === "multiselect-all")
                            allcircles[j].style.fillOpacity = 0.1;
                    }
                } 

                else if(this.checked === true)
                {
                    for (var j = 0; j < allcircles.length; j++)
                    {
                        if(allcircles[j].__data__.Gene === this.value.split(' ')[0] || this.value === "multiselect-all")
                            allcircles[j].style.fillOpacity = 0.7;
                    }
                }
            }
          
        }

         
     /*   
        //Append Ensembl Link
        if(gene !== "all") {
            //Add Link
            var a = document.createElement('a');
            var linkText = document.createTextNode("Ensembl");
            a.style.marginLeft = "25px";
            a.appendChild(linkText);
        
            a.href = "http://www.ensembl.org/Homo_sapiens/Gene/ExpressionAtlas?g=" + gene; 
            geneInnerNode.appendChild(a);

            var l = document.createElement('span');
            l.className = "fa fa-external-link";
            l.style.marginLeft = "0px";
            l.style.color = "blue";
            geneInnerNode.appendChild(l);
            //<span class="fa fa-external-link" aria-hidden="true"></span>
        } */
        
    }


    function filter() {
        var chr = document.getElementById("filterChr").value;
        var start = document.getElementById("filterStart").value;
        var end = document.getElementById("filterEnd").value;

        var endToggle = 0;

        if (end != "End")
            endToggle = 1;
        
        if (end == "")
            endToggle = 0;

        start = parseInt(start, 10);
        end = parseInt(end, 10);
        
        highlightC = chr;

        var selection = svg.selectAll("circle");

        selection.attr('r', function (d) {
            if(endToggle == 1)
                if (d.SNPChr == chr && d.SNPChrPos >= start && d.SNPChrPos <= end)
                    return 5;
                else
                    return 0;

            else if(endToggle == 0) {
                if ( ("c" + d.SNPChr) == chr && start <= d.SNPChrPos){
                    return 5;
                }
                else {
                    return 0;
                }
            }

        });

        var btn = document.getElementById("filter");
        btn.className = "btn btn-primary disabled";

        var btn = document.getElementById("unfilter");
        btn.className = "btn btn-primary active";
    }


    function unfilter() {
        highlightC = 0;
        var selection = svg.selectAll("circle");

        selection.attr('r', '5');
        
        var btn = document.getElementById("filter");
        btn.className = "btn btn-primary active";

        var btn = document.getElementById("unfilter");
        btn.className = "btn btn-primary disabled";   
    }


    function openFilter() {
        var filterDiv = document.getElementsByClassName('filter');
        var i = filterDiv.length;

        //var parent = document.getElementById("filterRow");
        var parent = document.getElementById("filterPl");
        var child = document.getElementById("openF");

        if(filterToggle == 0) {
            
            while(i--) {
                filterDiv[i].style.visibility = "visible";
            }         
            
            parent.className = "col-md-1";

            child.style.width = "70px";
            child.innerHTML = "Hide <<";

            filterToggle = 1;
        }

        else {
            while(i--) {
                filterDiv[i].style.visibility = "hidden";
            }         
            
            parent.className = "col-md-2";

            child.style.width = "155px";
            child.innerHTML = "Filter Results >>";

            filterToggle = 0;
        }

        //parent.removeChild(child);
    }


    function eqtlDetails(PValue, SNPName, SNPChr, SNPChrPos, Gene, ProbeChr, ProbeCenterChrPos ) {
        var eqtlNode = document.getElementById("eqtlDataDiv");
        var eqtlTitleNode = document.getElementById("eqtlTitleDiv");
        var eqtlInnerNode = document.getElementById("eqtlDataInnerDiv");
        var rsTableNode = document.getElementById("rsTableDiv");
        var gwasTableNode = document.getElementById("gwasTableDiv");

        var htmlcontent = PValue;
        var ensembleLink = "http://www.ensembl.org/Homo_sapiens/Gene/ExpressionAtlas?g=" + Gene;
        var snpPosLink = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPChr + SNPChrPos;
        var genePosLink = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPChr + SNPChrPos;
        var dbSNPLink = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPName;

        var span = "<span class='fa fa-external-link' style='margin-left: 2px; color: blue;'></span>";
        var space ="<span style='margin-left: 25px;'></span>";

        if(eqtlNode === null) {
            eqtlNode = document.createElement('div'); 
            
            eqtlNode.id = "eqtlDataDiv";
            eqtlNode.className = "col-md-5";
            eqtlNode.style.marginTop = "0px";
            eqtlNode.style.marginLeft = "80px";

            eqtlNode.style.fontSize = "14px";
            //eqtlNode.style.border = "1px solid #ccc";
            //eqtlNode.style.fontWeight = "bold";

            //geneNode.appendChild(eqtlNode);
            $("#transDiv").after(eqtlNode);
        }

        if(eqtlTitleNode === null) {
            eqtlTitleNode = document.createElement('div');

            eqtlTitleNode.id = "eqtlTitleDiv";
            eqtlTitleNode.style.textAlign = "center";
            //eqtlInnerNode.className = "col-md-4";
            //eqtlTitleNode.style.border = "1px solid #ccc";
            eqtlTitleNode.style.padding = "5px";

            eqtlNode.appendChild(eqtlTitleNode);
        }
        
        if(eqtlInnerNode === null) {
            eqtlInnerNode = document.createElement('div');

            eqtlInnerNode.id = "eqtlDataInnerDiv";
            //eqtlInnerNode.className = "col-md-4";
            eqtlInnerNode.style.border = "1px solid #ccc";
            eqtlInnerNode.style.padding = "10px";
            eqtlInnerNode.style.marginBottom = "20px";

            eqtlNode.appendChild(eqtlInnerNode);
        }

        if(rsTableNode === null) {
            rsTableNode = document.createElement('table');

            rsTableNode.id = "rsTableDiv";
            rsTableNode.className = "display";
            rsTableNode.style.border = "1px solid #ccc";
            rsTableNode.style.marginTop = "20px";
            rsTableNode.style.marginLeft = "0px";
            rsTableNode.style.padding = "5px";
            rsTableNode.style.fontSize = "small";

            eqtlNode.appendChild(rsTableNode);
        }

        if(gwasTableNode === null) {
            gwasTableNode = document.createElement('table');

            gwasTableNode.id = "gwasTableDiv";
            gwasTableNode.className = "display";
            gwasTableNode.style.border = "1px solid #ccc";
            gwasTableNode.style.marginTop = "20px";
            gwasTableNode.style.marginLeft = "0px";
            gwasTableNode.style.padding = "5px";
            gwasTableNode.style.fontSize = "small";

            eqtlNode.appendChild(gwasTableNode);
        }
    
        eqtlTitleNode.innerHTML = "<strong>" + "Trans-eQTL Details: " + "</strong>";

        eqtlInnerNode.innerHTML = "<div class=\"row\">" + "<div class=\"col-md-4\">" + 
            "<strong>" + "P-value: " + "</strong>" + "</div>" + "<div class=\"col-md-6\">" + PValue + "</div>" + "</div>" +
                "<div class=\"row\">" + "<div class=\"col-md-4\">" + 
            "<strong>" + "SNP-Pos: " + "</strong>" + "</div>" + "<div class=\"col-md-6\">" + SNPChr + ":" + SNPChrPos + "</div>" + "</div>" + 
                "<div class=\"row\">" + "<div class=\"col-md-4\">" +  
            "<strong>" + "Gene: " + "</strong>" + "</div>" + "<div class=\"col-md-3\">" + Gene + "</div>" + "<div class=\"col-md-3\">" + "<a href = " + ensembleLink + " target=\"_blank\">" + space + " Ensembl </a>" + span + "</div>" + "</div>" +
                "<div class=\"row\">" + "<div class=\"col-md-4\">" + 
            "<strong>" + "Gene-Pos: " + "</strong>" + "</div>" + "<div class=\"col-md-6\">" + ProbeChr + ":" + ProbeCenterChrPos + "</div>" + "</div>" +
                "<div class=\"row\">" + "<div class=\"col-md-4\">" + 
            "<strong>" + "rsid: " + "</strong>" + "</div>" + "<div class=\"col-md-3\">" + SNPName + "</div>" + "<div class=\"col-md-3\">" + "<a href = " + dbSNPLink + " target=\"_blank\">" + space + " dbSNP </a>" + span + "</div>" + "</div>";

        //  ;


        //   "<strong>" + "rsid: " + "</strong>" + SNPName;

        /*eqtlInnerNode.innerHTML = "<strong>" + "P-value: " + "</strong>" + PValue + "<br/>" + "<strong>" + "SNP-Pos: " + "</strong>" + SNPChr + ":" + SNPChrPos + "<br/>" + "<strong>" + "Gene: " + "</strong>" + Gene + "<br/>"  + "<strong>" + "Gene-Pos: " + "</strong>" + ProbeChr + ":" + ProbeCenterChrPos + "<br/>" + "<strong>" + "rsid: " + "</strong>" + SNPName; */
       /* 
        if(gene == "all")
            htmlcontent = "ALL";

        //Append Gene Name
        var p = document.createElement('span');
        var ptext = document.createTextNode(htmlcontent);
        p.style.marginLeft = "25px";
        p.style.fontSize = "16px";
        p.appendChild(ptext);
        geneInnerNode.appendChild(p);

        //Append Data Size
        var d = document.createElement('span');
        var dtext = dataSize + " trans-eQTLs";
        var dnode = document.createTextNode(dtext);
        d.style.marginLeft = "25px";
        d.style.fontSize = "14px";
        d.style.fontWeight = "normal";
        d.appendChild(dnode);
        geneInnerNode.appendChild(d);
    */
        //Append RS Link
        //if(gene !== "all") {

            //Add dbSNP Link
            /*        var a = document.createElement('a');
                    var linkText = document.createTextNode("dbSNP");
                    a.style.marginLeft = "25px";
                    a.appendChild(linkText);
                
                    a.href = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPName; 
                    eqtlInnerNode.appendChild(a);

                    var l = document.createElement('span');
                    l.className = "fa fa-external-link";
                    l.style.marginLeft = "2px";
                    l.style.color = "blue";
                    eqtlInnerNode.appendChild(l); */
            //<span class="fa fa-external-link" aria-hidden="true"></span>
        //} 


            var b = document.createElement('a');
            var linktextcontent = "Other Gene Targets for: '" + SNPName + "'";
            var linkText = document.createTextNode(linktextcontent);
            //b.style.marginLeft = "25px";
            b.style.textAlign = "center";
            b.appendChild(linkText);
            eqtlInnerNode.appendChild(b);

            
            var c = document.createElement('a');
            //c.id = "deneme";
            var newSpan = document.createElement('span');
            newSpan.id = "openTable";
            newSpan.style.marginLeft = "4px";
            newSpan.className = "glyphicon glyphicon-arrow-down";
            c.appendChild(newSpan);
            eqtlInnerNode.appendChild(c);

            //Table Initialization
            var header = rsTableNode.createTHead();                    
            var tblBody = document.createElement("tbody");
            rsTableNode.appendChild(tblBody);
            //var tr = document.getElementById('rsTableDiv').tHead.children[0];
            var th = document.createElement('th');
            th.innerHTML = "Gene";
           // header.appendChild(th);
            th.innerHTML = "P-Value";
           // header.appendChild(th);

            //a.href = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPName; 
            c.onclick = function() {  

                //Open Table Content
                if(newSpan.id == "openTable") 
                {     
                    //Change the icon
                    newSpan.className = "glyphicon glyphicon-arrow-up";
                    newSpan.id = "closeTable";

                    //Table exists
                    if (document.getElementById("rsTableDiv_wrapper")) 
                    {                                           
                        $("#rsTableDiv_wrapper").show();
                        //$("#saveTableClone").show();

                      /*  var tableDiv = document.getElementById("rsTableDiv_wrapper");
                        tableDiv.style.visibility = "visible";

                        var saveTableClone = document.getElementById("saveTableClone");
                        saveTableClone.style.visibility = "visible"; */
                    }       

                    //Create Table
                    else
                    {
                        var formatP = d3.format(",.4e");         
                        var rsArr = [];
                        //SNP_interest = SNPName;

                        //console.log("TRANS DATA: ", transData);
                        for(var i = 0; i < transData.length; i++) {
                            for(var j = 0; j < transData[i].length; j++)
                                if(transData[i][j].SNPName === SNPName){
                                    rsArr.push(transData[i][j]);
                                    rsArr[rsArr.length-1].PValue = formatP(rsArr[rsArr.length-1].PValue);
                                }
                        }

                        //console.log("AAAA: ", rsArr[0]);

                        $('#rsTableDiv').DataTable( {
                            data: rsArr,

                            columns: [
                                { data: 'Gene', "title": 'Gene', 
                                    "render": function ( data, type, full, meta ) {
                                        return '<a href="#" onClick="addTrans(\''+data+'\')">'+data+'</a>';
                                    } 
                                },
                                { data: 'PValue', "title": 'P-Value' },                      
                                { data: 'ProbeChr', "title": 'Chr' },
                                { data: 'ProbeCenterChrPos', "title": 'Center-Pos'}         
                            ]
                        } );

                        //$('#rsTableDiv.caption').text('Table: eQTL Target Genes'); 
                        $('#rsTableDiv').append('<caption>Table: eQTL Target Genes</caption>');

                        //Save Table Option
                    /*    var saveTableRow = document.getElementById("saveTableRow"); 
                        var eqtlDataDiv = document.getElementById("eqtlDataDiv");
                        
                        var saveTableClone = saveTableRow.cloneNode(true);
                        saveTableClone.id = "saveTableClone";

                        eqtlDataDiv.appendChild(saveTableClone);
                        
                        saveTableClone.style.visibility = "visible"; */

                    }

                }

                //Hide Table Content
                else
                {
                    newSpan.className = "glyphicon glyphicon-arrow-down";
                    newSpan.id = "openTable";

                    $("#rsTableDiv_wrapper").hide();
                    //$("#saveTableClone").hide();

                    /*var saveTableClone = document.getElementById("saveTableClone");
                    saveTableClone.style.visibility = "hidden";

                    var tableDiv = document.getElementById("rsTableDiv_wrapper");
                    tableDiv.style.visibility = "hidden";//remove(); */
                }

            }


            //GWAS Data TABLE Creation...
            var gwasArr = gwasData[0].filter(function(x) { 
                                    return (x.Strongest_SNP_Risk_Allele).split('-')[0] === SNPName; 
                                });

            if(gwasArr.length > 0)
            {
                var br = document.createElement('br');
                eqtlInnerNode.appendChild(br);

                var g = document.createElement('a');
                var linktextcontent = "GWAS Results (" + gwasArr.length + ") for: '" + SNPName + "'";
                var linkText = document.createTextNode(linktextcontent);
                //b.style.marginLeft = "25px";
                g.style.textAlign = "center";
                g.appendChild(linkText);
                eqtlInnerNode.appendChild(g);

                
                var h = document.createElement('a');
                //c.id = "deneme";
                var newSpan2 = document.createElement('span');
                newSpan2.id = "openTableGwas";
                newSpan2.style.marginLeft = "4px";
                newSpan2.className = "glyphicon glyphicon-arrow-down";
                h.appendChild(newSpan2);
                eqtlInnerNode.appendChild(h);

                //Table Initialization
                var header = gwasTableNode.createTHead();                    
                var tblBody = document.createElement("tbody");
                gwasTableNode.appendChild(tblBody);
                //var tr = document.getElementById('rsTableDiv').tHead.children[0];
                var th = document.createElement('th');
                th.innerHTML = "Gene";
               // header.appendChild(th);
                th.innerHTML = "P-Value";
               // header.appendChild(th);

                //a.href = "https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=" + SNPName; 
                h.onclick = function() {  

                    //Open Table Content
                    if(newSpan2.id == "openTableGwas") 
                    {     
                        //Change the icon
                        newSpan2.className = "glyphicon glyphicon-arrow-up";
                        newSpan2.id = "closeTableGwas";

                        //Table exists
                        if (document.getElementById("gwasTableDiv_wrapper")) 
                        {                                           
                            $("#gwasTableDiv_wrapper").show();
                            //$("#saveTableClone").show();
                            /*var tableDiv = document.getElementById("gwasTableDiv_wrapper");
                            tableDiv.style.visibility = "visible";

                            var saveTableClone = document.getElementById("saveTableClone");
                            saveTableClone.style.visibility = "visible";*/
                        }       

                        //Create Table
                        else
                        {
                            //console.log("GGGG: ", gwasArr[0]);

                            $('#gwasTableDiv').DataTable( {
                                data: gwasArr,

                                columns: [
                                    { data: 'Disease_Phenotype', "title": 'Disease/Phenotype' },
                                    { data: 'P-value', "title": 'P-Value' },                      
                                    { data: 'Odds ratio or beta', "title": 'Odds-ratio/beta' },
                                    { data: 'PUBMEDID', "title": 'Pubmed ID' ,
                                     "render": function ( data, type, full, meta ) {
                                            var pmed = "https://www.ncbi.nlm.nih.gov/pubmed/?term=" + data;
                                            var pmedlink = "<a href = " + pmed + " target=\"_blank\">" + data + "</a>";
                                            return pmedlink;
                                        } 
                                    }         
                                ]
                            } );

                            //$('#rsTableDiv.caption').text('Table: eQTL Target Genes'); 
                            $('#gwasTableDiv').append('<caption>Table: GWAS Results</caption>');

                            //Save Table Option
                        /*    var saveTableRow = document.getElementById("saveTableRow"); 
                            var eqtlDataDiv = document.getElementById("eqtlDataDiv");
                            
                            var saveTableClone = saveTableRow.cloneNode(true);
                            saveTableClone.id = "saveTableClone";

                            eqtlDataDiv.appendChild(saveTableClone);
                            
                            saveTableClone.style.visibility = "visible"; */

                        }

                    }

                    //Hide Table Content
                    else
                    {
                        newSpan2.className = "glyphicon glyphicon-arrow-down";
                        newSpan2.id = "openTableGwas";

                        $("#gwasTableDiv_wrapper").hide();
                        //$("#saveTableClone").hide();

                        /*var saveTableClone = document.getElementById("saveTableClone");
                        saveTableClone.style.visibility = "hidden";

                        var tableDiv = document.getElementById("gwasTableDiv_wrapper");
                        tableDiv.style.visibility = "hidden";//remove();*/
                    }

                }
            }

            
            
    }


    function compare(a,b) {
          if (a.Gene.length < b.Gene.length)
            return -1;
          if (a.Gene.length > b.Gene.length)
            return 1;
          
          return 0;
    }


    function geneSetTrans(frequency, source) {

        var sourceArr = [], geneArr = [], fullArr = [], obj = {}, genes, seenGenes = [];
        var transNode = document.getElementById("transDiv");
        var geneSetNode = document.getElementById("geneSetDiv");

        $('#transDiv').empty(); // Remove contents of transDiv (trans eqtls)
        $('#geneDataDiv').remove(); //remove Gene Data
        $('#eqtlDataDiv').remove(); // Remove eqtl details

        var filterRow = document.getElementById("filterRow");
        filterRow.style.height = "0px";
        filterRow.style.visibility = "hidden";

        var filterCol = document.getElementById("filterCol");
        filterCol.style.height = "0px";
        filterCol.style.visibility = "hidden";

        var plotRow = document.getElementById("plotRow");
        plotRow.style.height = "0px";
        plotRow.style.visibility = "hidden";
        var plotCol = document.getElementById("plotCol");
        plotCol.style.height = "0px";

        sourceArr = Object.keys(source);
        //console.log("GGG: ", sourceArr.length);
        for(var i = 0; i < sourceArr.length; i++) {
            seenGenes = [];
            genes = "";
            Object.keys(source[sourceArr[i]]).forEach(function(key) {

                //for (var j = 0; j < seenGenes.length; j++) {
                    if( !isInArray(source[sourceArr[i]][key].Gene, seenGenes) ) {
                        seenGenes.push(source[sourceArr[i]][key].Gene);
                        genes = genes + source[sourceArr[i]][key].Gene + "; ";
                    }

            });
            //genes = source[sourceArr[i]].Gene;
            genes = genes.slice(0, -2);
            //console.log("GGG: ", genes);
            if(seenGenes.length > 1) {
                obj = {rsid: sourceArr[i], Gene: genes };
                fullArr.push(obj); //= source[i].key; 
            }
        }

        if(geneSetNode === null) {
            geneSetNode = document.createElement('table');

            geneSetNode.id = "geneSetDiv";
            geneSetNode.className = "display";
            geneSetNode.style.border = "1px solid #ccc";
            geneSetNode.style.marginTop = "-20px";
            //geneSetNode.style.marginLeft = "50px";
            //geneSetNode.style.marginRight = "50px";
            geneSetNode.style.padding = "5px";
            //geneSetNode.style.fontSize = "small";

            transNode.appendChild(geneSetNode);
        }

        //Table Initialization
            var header = geneSetNode.createTHead();                    
            var tblBody = document.createElement("tbody");
            geneSetNode.appendChild(tblBody);
            //var tr = document.getElementById('rsTableDiv').tHead.children[0];
            var th = document.createElement('th');

            //console.log("SSSS: ", source);
            //console.log("sourceArr: ", sourceArr);
            //console.log("fullArr: ", fullArr);
            fullArr.sort(compare);

        $('#geneSetDiv').DataTable( {
                    data: fullArr,
                    "order": [[ 0, "desc" ]],
                    retrieve: true,
                    columns: [
                        /*{ data: 'Gene', "title": 'Gene', 
                            "render": function ( data, type, full, meta ) {
                                return '<a href="#" onClick="addTrans(\''+data+'\')">'+data+'</a>';
                            } 
                        },*/
                        { data: 'Gene.length', "title": 'deneme', "visible": false},
                        { data: 'rsid', "title": 'SNP' },
                        { data: 'Gene', "title": 'Gene' }

                        
                        //{ data: 'ProbeCenterChrPos', "title": 'Center-Pos'}         
                    ]
                } );

    }


    function geneSetDrawTrans(source) {
            var dataSize = geneData.length;
           // console.log("geneData length: ", dataSize);
            
            var vizDiv = document.getElementById("transDiv");

            /*if(dataSize == 0) {              
                vizDiv.style.fontSize = "14px";
                vizDiv.style.fontWeight = "bold";
                vizDiv.style.textAlign = "center";
                vizDiv.style.border = "1px solid black";
                vizDiv.innerHTML = "No Results Found";
                removeControls();
                removefilterControl();
                $('#geneDataDiv').empty(); //remove Gene Data
            }

            else {*/
                $('#transDiv').empty();
                //vizDiv.innerHTML = "";
                vizDiv.style.border = "";
                vizDiv.style.textAlign = "left";
                
                removeControls();

                           
                //addGeneData(gene, dataSize);
                //addfilterControl();
                drawTrans(geneData, geneData[0].PValue, dataSize);
                /*if(dataSize > 50) {
                    addControls();
                    //updateRange(0, 49);
                }*/
            
            
        
        //console.log("geneData[0]: ", geneData[0]);
          
    


    }


    function drawTrans(data, topP, dataSize) {       
        //draw in 'transDiv'
        var viz = d3.select('#transDiv');
        
        //var wdth = 900, hght = 400;
        //if (dataSize >= 50)
            wdth = 620; //610
        
       /* else
            wdth = (dataSize * 12) + 10;

        if(wdth < 200)
            wdth = 200; */
        //console.log('GWAS DATA:', gwasData);
        //console.log('GWAS DATA[0]:', gwasData[0]);
        //console.log('GWAS DATA[0][0]:', gwasData[0][0]);
        //console.log('GWAS DATA[0][0].PUBMEDID:', gwasData[0][0].PUBMEDID);

        var spinner = new Spinner();
        spinner.spin(document.getElementById("filterRow"));
        
        var gene = document.getElementById("geneVal").value;
        var lastChar = gene.substr(gene.length - 1);

        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        if(gene == "")
            gene = "all";

        var genePlaceholder = document.getElementById("geneVal");
        genePlaceholder.placeholder = "Gene";

        var superscript = "⁰¹²³⁴⁵⁶⁷⁸⁹",
            formatPower = function(d) { return (d + "").split("").map(function(c) { return superscript[c]; }).join(""); };
        
        svg = viz.append('svg')
                    .attr({
                        width: wdth + 30,
                        height: hght + 20
                    })
                    .append("svg:g")
                    .attr("class", "graph-svg-component")
                    .attr("id", "trans-svg")
                    .attr("transform", "translate(" + 0 + "," + 0 +")");

        var xScale = d3.scale.linear()
                        .domain([1, 100]) 
                        .range([0,wdth]);
        
        var xAxis = d3.svg.axis()
                        .scale(xScale)
                        .orient("bottom")
                        .ticks(0)
                        .tickSize(1);

        var yScale = d3.scale.log()
                        .domain([1, topP]) 
                        .range([hght - 10,10]); 
        
        var y = d3.scale.linear()
                        //.base(Math.E)
                        .domain([1e-5, topP])
                        .range([hght - 10, 0]);

        var yAxis = d3.svg.axis()
                        .scale(yScale)                      
                        .tickFormat(function(d) { return "e" + Math.round(Math.log(d)); })
                        .orient("left")
                        .tickValues([1e-100,1e-80,1e-40,1e-20])
                        .ticks(8)
                        .tickSize(1);
        

        // Define the div for the tooltip
        var div = d3.select("body")
                        .append("div")   
                        .attr("class", "tooltip")               
                        .style("opacity", 0);

        var formatP = d3.format(",.4e");

        var selection = svg.selectAll("circle")
                            .data(data, function(d) { return d.PValue+""+d.SNPName; });

        selection.exit().remove();
        
        selection.enter().append('circle')
                        .attr('class', 'circle')
                        .attr('cx', function (d, i) {
                            if(plot == 1)
                                return (i+2)*12 + 10;

                            else if(plot == 2) 
                            {
                                var chrStartInd = [45, 95, 143, 183, 211, 257, 291, 323, 352, 380, 407, 434, 461, 484, 505, 525, 543, 560, 576, 588, 601, 610]; //+25
                                return chrStartInd[d.SNPChr - 1] + (d.SNPChrPos / 5000000);
                            }
                                //return (d.SNPChr)*24;
                        })  
                        .attr('cy', function (d) {return yScale(d.PValue)+5;})//yScale(Math.pow(d.PValue, 0.46))+5;})
                        .attr('r', function (d) {
                            if(d.SNPName == SNP_interest)
                                return 6;    
                            else
                                return 5;
                        })
                        .attr("transform", "translate(20,0)")
                        .style("fill", function (d) {
                               var gwaslist = gwasData[0].filter(function(x) { 
                                    return (x.Strongest_SNP_Risk_Allele).split('-')[0] === d.SNPName; 
                                });
                                //console.log(JSON.stringify(gwaslist));

                                if(d.SNPName == SNP_interest)
                                    return "red";

                                if(gwaslist.length > 0)
                                    return "black";
                                         

                              //  if(d.SNPName == SNP_hover)
                                //    return "red";
                                
                            /*    if(plot == 2) {
                                    if(d.SNPChr % 2 == 0)
                                        return "darkorange";
                                } */
                        })
                        .on("mouseover", function(d) {
                            this.setAttribute('r', '8');
                            d3.select(this).style('fill', 'red');
                            //SNP_hover = d.SNPName;
                            
                            var tipHtml = "<strong>" + "P-value: " + "</strong>" + formatP(d.PValue) + "<br/>" + 
                                        "<strong>" + "rsid: " + "</strong>" + d.SNPName + "<br/>"  + 
                                        "<strong>" + "SNP-Pos: " + "</strong>" + d.SNPChr + ":" + d.SNPChrPos + "<br/>" +
                                        "<strong>" + "Gene: " + "</strong>" + d.Gene + "<br/>"  +
                                        "<strong>" + "Gene-Pos: " + "</strong>" + d.ProbeChr + ":" + d.ProbeCenterChrPos;

                            var gwaslist = gwasData[0].filter(function(x) { 
                                    return (x.Strongest_SNP_Risk_Allele).split('-')[0] === d.SNPName; 
                                });
                            
                            for (var i = 0; i < gwaslist.length; i++)
                            {
                                tipHtml = tipHtml + "<hr style=\"height:1px;\">" + "<strong>" + "Disease/Trait: " + "</strong>" +  gwaslist[i].Disease_Phenotype + "<br/>"   + "<strong>" + "Pubmed ID: " + "</strong>" + gwaslist[i].PUBMEDID + "<br/>";
                            }
                           /* console.log('GWAS:::', gwaslist);
                            console.log('GWAS-length:', gwaslist.length);
                            console.log('GWAS[0]:', gwaslist[0]);
                            console.log('GWAS[0]-PUBMEDID:', gwaslist[0].PUBMEDID); */

                            

                            div.transition()        
                                .duration(100)      
                                .style("opacity", .9);     

                            div.html(tipHtml)  
                                .style("left", (d3.event.pageX + 10) + "px")     
                                .style("top", (d3.event.pageY - 28) + "px"); 
                           /* div.html("<strong>" + "P-value: " + "</strong>" + formatP(d.PValue) + "<br/>"   + "<strong>" + "rsid: " + "</strong>" + d.SNPName + "<br/>"  + 
                                     "<strong>" + "SNP-Pos: " + "</strong>" + d.SNPChr + ":" + d.SNPChrPos + "<br/>" +
                                     "<strong>" + "Gene: " + "</strong>" + d.Gene + "<br/>"  +
                                     "<strong>" + "Gene-Pos: " + "</strong>" + d.ProbeChr + ":" + d.ProbeCenterChrPos + "<hr>")  
                                .style("left", (d3.event.pageX + 10) + "px")     
                                .style("top", (d3.event.pageY - 28) + "px"); */

                        })
                        .on("click", function(d){
                            SNP_interest = d.SNPName;

                            d3.selectAll(".tooltip").remove();
                            
                            addTrans(gene);

                            $('.dataTables_wrapper').empty();
                            $('#gwasTableDiv_wrapper').remove();
                            //$('#saveTableClone').remove();
                            $('#rsTableDiv_wrapper').remove();
                            eqtlDetails(formatP(d.PValue), d.SNPName, d.SNPChr, d.SNPChrPos, d.Gene, d.ProbeChr, d.ProbeCenterChrPos );
                        })
                        .on("mouseout", function(d) {
                            
                            d3.select(this).style('fill', function (d) {
                                
                                var gwaslist = gwasData[0].filter(function(x) { 
                                    return (x.Strongest_SNP_Risk_Allele).split('-')[0] === d.SNPName; 
                                });

                                if(d.SNPName == SNP_interest)
                                    return "red";

                                if(gwaslist.length > 0)
                                    return "black";
                                
                            /* if(plot == 2) {
                                    if(d.SNPChr % 2 == 0)
                                        return "darkorange";
                                }

                                else
                                    return "rgb(30,144,255)"; */
                                }); 

                            if(d.SNPName == SNP_interest)
                                this.setAttribute('r', '6');
                            
                            else
                                this.setAttribute('r', '5');
                            
                            div.transition()        
                                .duration(100)      
                                .style("opacity", 0);
                        
                        });
     
        /*
        //Add Title
        svg.append("text")
                .attr("x", (wdth / 2))             
                .attr("y", 20)
                .attr("text-anchor", "middle")  
                .style("font-size", "16px")
                .style("font-weight", "bold") 
                //.style("text-decoration", "underline")  
                .text("Dataset: Westra");
        
        
        svg.append("text")
                .attr("x", (wdth / 2))             
                .attr("y", 40)
                .attr("text-anchor", "middle")  
                .style("font-size", "16px") 
                //.style("text-decoration", "underline")  
                .text("Trans-eQTL Graph");

       */

        svg.append("text")
              .attr("transform", "rotate(-90)")
              .attr("y", 0)
              .attr("x", -200)
              .attr("dy", "1em")
              .style("text-anchor", "middle")
              .style("font-size", "12px")
              .style("font-weight", "normal")
              .text("-log10(P-value)");


        svg.append("text")
                .attr("x", (wdth / 2 ))             
                .attr("y", 440)
                .attr("text-anchor", "middle")  
                .style("font-size", "14px") 
                //.style("text-decoration", "underline")  
                .text("Trans-eQTLs");
        
        
        // create left yAxis
        svg.append("g")
                .attr("class", "axis axis--y")
                .attr("transform", "translate(45, 0)")
                .call(yAxis);

        // create xAxis
        svg.append("g")
                .attr("class", "axis axis--x")
                .attr("transform", "translate(45, 400)")
                .call(xAxis);

        
        //add border
       svg.append("rect")
                .attr("x", 0)
                .attr("y", 0)
                .attr("height", hght+20)
                .attr("width", wdth+30)
                .style("stroke", "dodgerblue")
                .style("fill", "none")
                .style("stroke-width", 1);

        spinner.stop();
    }


    function manhattanPlot()
    {
        
        if(document.getElementById("manPlot").innerText == "Manhattan Plot")
        {

            var svg = d3.select("body").transition();

            svg.selectAll(".circle")   // change the line
                .duration(750)
                .attr('cx', function (d, i) {         
                    var chrStartInd = [45, 95, 143, 183, 211, 257, 291, 323, 352, 380, 407, 434, 461, 484, 505, 525, 543, 560, 576, 588, 601, 610]; //+25
                    //var chrStartInd = [20, 70, 118, 158, 196, 232, 266, 298, 327, 355, 382, 409, 436, 459, 480, 500, 518, 535, 551, 563, 576, 585];
                    return chrStartInd[d.SNPChr - 1] + (d.SNPChrPos / 5000000);//(d.SNPChr)*24;//chrStartInd[d.SNPChr] + (d.SNPChrPos / 5000000);
                })/*
                .style("fill", function (d) {
                    if(d.SNPName == SNP_interest)
                        return "red";

                    if(d.SNPChr % 2 == 0)
                        return "darkorange";
                })*/; 

            plot = 2;

            document.getElementById("manPlot").innerText = "P-value Ordered Plot";
            document.getElementById("manPlot").style.width = "220px";

            var xScale = d3.scale.linear()
                        .domain([1, 600]) 
                        .range([0,600]);
        

         //   vis.select(".yaxis")
         //           .transition().duration(1500).ease("sin-in-out")  // https://github.com/mbostock/d3/wiki/Transitions#wiki-d3_ease
         //           .call(yAxis);

            var xAxis = d3.svg.axis().scale(xScale).orient("bottom").tickValues([2, 70, 118, 158, 196, 232, 266, 298, 327, 355, 382, 409, 436, 459, 480, 500, 518, 535, 551, 563, 574, 585,600]).tickFormat(function(n, i) { return i+1 }).tickSize(5);

            svg.select(".axis--x").transition().duration(500).call(xAxis).style("font-size", "xx-small").style("font-weight", "400"); 

         }


        else if(document.getElementById("manPlot").innerText == "P-value Ordered Plot")
        {

            var svg = d3.select("body").transition();

            svg.selectAll(".circle")   // change the line
                .duration(750)
                .attr('cx', function (d, i) {
                    return (i+2)*12 + 10;
                })/*
                .style("fill", function (d) {
                    if(d.SNPName == SNP_interest)
                        return "red";
                    
                    else
                        return "rgb(30,144,255)";
                })*/; 

            plot = 1;

            document.getElementById("manPlot").innerText = "Manhattan Plot";
            document.getElementById("manPlot").style.width = "170px";

            var xScale = d3.scale.linear()
                        .domain([1, 100]) 
                        .range([0,wdth]);

            var xAxis = d3.svg.axis()
                        .scale(xScale)
                        .orient("bottom")
                        .ticks(0)
                        .tickSize(1);

            svg.select(".axis--x").transition().duration(750).call(xAxis);

         }

    }



    function drawCis(datasetvalues) {
        var cisDiv = document.getElementById("igvDiv");
        cisDiv.style.visibility = "visible";
        cisDiv.style.marginTop = "-10px";

        var genePlaceholder = document.getElementById("geneVal");
        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);
        
        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        var location = gene;

        if (location == "") {
            location = "chr1:155,160,475-155,184,282";
            genePlaceholder.placeholder = location;
        }

        else
            genePlaceholder.placeholder = "Gene";

        var div = $("#igvDiv")[0],
                options = {
                    showNavigation: true,
                    showRuler: true,
                    locus: location,
                    reference: {
                        id: "hg19"
                    },
                    formats: {
                            gwasSNPS: {
                                coords: 0,
                                chr: 0,
                                start: 1,
                                end: 2,
                                fields: ["Chr", "chromStart", "chromEnd", "Strongest_SNP_risk_allele", "Disease_Phenotype", "P-value", "Odds ratio or beta", "PUBMEDID"]
                            }
                        },
                    tracks: [
                            {
                                featureType: 'annotation',
                                format: 'gwasSNPS',
                                indexed: false,
                                color: 'rgb(100,200,200)',
                                displayMode: 'EXPANDED',
                                url: "./data/gwas.txt",
                                name: 'GWAS Catalog',
                                height: "150",
                                order: 9999
                            },
                        {
                            name: "Genes",
                            type: "annotation",
                            format: "gtf",
                            sourceType: "file",
                            height: "200",
                            url: "https://s3.amazonaws.com/igv.broadinstitute.org/annotations/hg19/genes/gencode.v18.annotation.sorted.gtf.gz",
                            indexURL: "https://s3.amazonaws.com/igv.broadinstitute.org/annotations/hg19/genes/gencode.v18.annotation.sorted.gtf.gz.tbi",
                            visibilityWindow: 10000000,
                            order: Number.MAX_VALUE,
                            order: 10000,
                            displayMode: "EXPANDED"
                        },

                      /*  {
                                     url: './data/gwas.txt',
                                    name: 'GWAS',
                                    format: 'gtexGWAS',
                                    featureType: 'gwas',
                                    //colorScale: {
                                    //    thresholds: [],
                                    //    colors:['rgb(122,179,23)']
                                    //},
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    minLogP: 10,
                                    maxLogP: 16,
                                    height: 150,
                                    //commonCis: CommonCisData,
                                    label: 'GWAS'} */


                    ]
                };

        igv.createBrowser(div, options);

        setTimeout(loadCisTracks, 1000, datasetvalues);

    }


    function loadCisTracks(datasetvalues) {
        var dataset = 13;//document.getElementById("datasetT").value;
        var commonCis = [];
        var remaining = datasetvalues.length;

        //console.log("Remaining: ", remaining);
        console.log('SPINNNN...');
        var spinner = new Spinner();
        spinner.spin(document.getElementById("queryRow"));

        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);

        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);

        //console.log("Datasetvalue length: ", datasetvalues.length);
        for (var i = 0; i < datasetvalues.length; i++) {

            //Framingham dataset
            if(datasetvalues[i] == 11) {
                var file = "./data/fram/fram/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData11 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            //GTEx dataset
            else if (datasetvalues[i] == 12) {
                var file = "./data/gtex/gtex/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData12 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            //Westra dataset
            else if (datasetvalues[i] == 13) {
                var file = "./data/westra/westra/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData13 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 14) {
                var file = "./data/lude/lude/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData14 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 15) {
                var file = "./data/pierce/pierce/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData15 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 16) {
                d3.tsv("./data/yamada/yamada.txt", function(rows16) {
                    cisData16 = rows16;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 21) {                
                var file = "./data/jager/monocytes-aa/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData21 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                }); 
            }

            else if (datasetvalues[i] == 22) {
                var file = "./data/jager/monocytes-ea/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData22 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });               
            }

            else if (datasetvalues[i] == 23) {
                var file = "./data/jager/monocytes-eu/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData23 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 25) {               
                d3.tsv("./data/fairfax/mono.txt", function(rows25) {
                    cisData25 = rows25;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 26) {               
                var file = "./data/fairfax/mono-naive/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData26 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 31) {
                d3.tsv("./data/jager/cd4T-aa.txt", function(rows31) {
                    cisData31 = rows31;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });               
            }

            else if (datasetvalues[i] == 32) {
                d3.tsv("./data/jager/cd4T-ea.txt", function(rows32) {
                    cisData32 = rows32;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 33) {
                var file = "./data/jager/cd4T-eu/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData33 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });               
            }

            else if (datasetvalues[i] == 41) {
                d3.tsv("./data/fairfax/bcell.txt", function(rows41) {
                    cisData41 = rows41;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 51) {
                d3.tsv("./data/fairfax/neutrophils.txt", function(rows51) {
                    cisData51 = rows51;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });
            }

            else if (datasetvalues[i] == 61) {
                var file = "./data/fairfax/mono-lps2/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData61 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 62) {
                var file = "./data/fairfax/mono-lps24/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData62 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });              
            }

            else if (datasetvalues[i] == 63) {
                var file = "./data/fairfax/mono-ifn/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData63 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 71) {
                var file = "./data/dermitzakis/eur/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData71 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 72) {
                var file = "./data/dermitzakis/yri/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData72 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 81) {
                var file = "./data/heijmans/meqtl/" + gene;  
                
                d3.text(file, function(r) { 
                    var result = "GENE\tSNP\n" + r;
                    cisData81 = d3.tsv.parse(result);
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 82) {
                d3.tsv("./data/heijmans/eqtm.txt", function(rows82) {
                    cisData82 = rows82;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 101) {
                d3.tsv("./data/user/user1.txt", function(rows101) { 
                    cisData101 = rows101;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                
            }

            else if (datasetvalues[i] == 102) {
                d3.tsv("./data/user/user2.txt", function(rows102) { 
                    cisData102 = rows102;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });               
            }

            else if (datasetvalues[i] == 103) {
                d3.tsv("./data/user/user3.txt", function(rows103) { 
                    cisData103 = rows103;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });               
            }

            else if (datasetvalues[i] == 201) {
                d3.tsv("./data/emory/cis-day0.txt", function(rows201) {
                    cisData201 = rows201;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 202) {
                d3.tsv("./data/emory/cis-day1.txt", function(rows202) {
                    cisData202 = rows202;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 203) {
                d3.tsv("./data/emory/cis-day3.txt", function(rows203) {
                    cisData203 = rows203;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 204) {
                d3.tsv("./data/emory/cis-day7.txt", function(rows204) {
                    cisData204 = rows204;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            else if (datasetvalues[i] == 205) {
                d3.tsv("./data/emory/cis-day14.txt", function(rows205) {
                    cisData205 = rows205;
                    remaining--;
                    
                    if(remaining == 0)
                        drawCisTracks(datasetvalues); 
                });                 
            }

            //Study does not have cis-eqtl data
            else
                remaining--;
        }

        spinner.stop();

    }


    function drawCisTracks(datasetvalues) {
        var geneCis = [];
        var gene = document.getElementById("geneVal").value;

        var lastChar = gene.substr(gene.length - 1);

        if(lastChar == ',')
            gene = gene.substring(0, gene.length - 1);
        
        var obj = {};


        //console.log("DATASET VALUES: ", datasetvalues);
       
        for (var i = 0; i < datasetvalues.length; i++) {

            if(datasetvalues[i] == 11) {
                for(var j = 0; j < cisData11.length; j++)
                {
                    if(cisData11[j].GENE == gene ) 
                    {
                        obj = {source: "11", snp: cisData11[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 12) {
                for(var j = 0; j < cisData12.length; j++)
                {
                    if(cisData12[j].GENE == gene ) 
                    {
                        obj = {source: "12", snp: cisData12[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 13) {
                for(var j = 0; j < cisData13.length; j++)
                {
                    if(cisData13[j].GENE == gene ) 
                    {
                        obj = {source: "13", snp: cisData13[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 14) {
                for(var j = 0; j < cisData14.length; j++)
                {
                    if(cisData14[j].GENE == gene ) 
                    {
                        obj = {source: "14", snp: cisData14[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 15) {
                for(var j = 0; j < cisData15.length; j++)
                {
                    if(cisData15[j].GENE == gene ) 
                    {
                        obj = {source: "15", snp: cisData15[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 16) {
                for(var j = 0; j < cisData16.length; j++)
                {
                    if(cisData16[j].GENE == gene ) 
                    {
                        obj = {source: "16", snp: cisData16[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }


            else if(datasetvalues[i] == 21) {
                for(var j = 0; j < cisData21.length; j++)
                {
                    if(cisData21[j].GENE == gene ) 
                    {
                        obj = {source: "21", snp: cisData21[j].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData21: ", cisData21);
            }

            else if(datasetvalues[i] == 22) {
                for(var k = 0; k < cisData22.length; k++)
                {
                    if(cisData22[k].GENE == gene )
                    {
                        obj = {source: "22", snp: cisData22[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 23) {
                for(var k = 0; k < cisData23.length; k++)
                {
                    if(cisData23[k].GENE == gene )
                    {
                        obj = {source: "23", snp: cisData23[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 25) {
                for(var k = 0; k < cisData25.length; k++)
                {
                    if(cisData25[k].GENE == gene )
                    {
                        obj = {source: "25", snp: cisData25[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 26) {
                for(var k = 0; k < cisData26.length; k++)
                {
                    if(cisData26[k].GENE == gene )
                    {
                        obj = {source: "26", snp: cisData26[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 31) {
                for(var k = 0; k < cisData31.length; k++)
                {
                    if(cisData31[k].GENE == gene )
                    {
                        obj = {source: "31", snp: cisData31[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 32) {
                for(var k = 0; k < cisData32.length; k++)
                {
                    if(cisData32[k].GENE == gene )
                    {
                        obj = {source: "32", snp: cisData32[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 33) {
                for(var k = 0; k < cisData33.length; k++)
                {
                    if(cisData33[k].GENE == gene )
                    {
                        obj = {source: "33", snp: cisData33[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 41) {
                for(var k = 0; k < cisData41.length; k++)
                {
                    if(cisData41[k].GENE == gene )
                    {
                        obj = {source: "41", snp: cisData41[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 51) {
                for(var k = 0; k < cisData51.length; k++)
                {
                    if(cisData51[k].GENE == gene )
                    {
                        obj = {source: "51", snp: cisData51[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 61) {
                for(var k = 0; k < cisData61.length; k++)
                {
                    if(cisData61[k].GENE == gene )
                    {
                        obj = {source: "61", snp: cisData61[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 62) {
                for(var k = 0; k < cisData62.length; k++)
                {
                    if(cisData62[k].GENE == gene )
                    {
                        obj = {source: "62", snp: cisData62[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 63) {
                for(var k = 0; k < cisData63.length; k++)
                {
                    if(cisData63[k].GENE == gene )
                    {
                        obj = {source: "63", snp: cisData63[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 71) {
                for(var k = 0; k < cisData71.length; k++)
                {
                    if(cisData71[k].GENE == gene )
                    {
                        obj = {source: "71", snp: cisData71[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 72) {
                for(var k = 0; k < cisData72.length; k++)
                {
                        obj = {source: "72", snp: cisData72[k].SNP}
                        geneCis.push(obj);
                }
            }

            else if(datasetvalues[i] == 81) {
                for(var k = 0; k < cisData81.length; k++)
                {
                    if(cisData81[k].GENE == gene )
                    {
                        obj = {source: "81", snp: cisData81[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 82) {
                for(var k = 0; k < cisData82.length; k++)
                {
                    if(cisData82[k].GENE == gene )
                    {
                        obj = {source: "82", snp: cisData82[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 101) {
                for(var k = 0; k < cisData101.length; k++)
                {
                    if(cisData101[k].GENE == gene )
                    {
                        obj = {source: "101", snp: cisData101[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 102) {
                for(var k = 0; k < cisData102.length; k++)
                {
                    if(cisData102[k].GENE == gene )
                    {
                        obj = {source: "102", snp: cisData102[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

            else if(datasetvalues[i] == 103) {
                for(var k = 0; k < cisData103.length; k++)
                {
                    if(cisData103[k].GENE == gene )
                    {
                        obj = {source: "103", snp: cisData103[k].SNP}
                        geneCis.push(obj);
                    }
                }
                //console.log("CisData63: ", cisData63);
            }

           
        }

        //console.log("GeneCis: ", geneCis);
        var CommonCisData = calcCommonCis(geneCis);
        //console.log("CommonCisData: ", CommonCisData);

        addLegends();
        //console.log('cisData63:::', cisData63);
        
           // };

        for (var i = 0; i < datasetvalues.length; i++) {

            if(datasetvalues[i] == 11) {
                igv.browser.loadTrack({
                                    url: './data/fram-sorted.txt.gz',
                                    indexURL: './data/fram-sorted.txt.gz.tbi',
                                    name: 'Framingham',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    minLogP: 10,
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Framingham'});
            }

            else if(datasetvalues[i] == 12) {
                igv.browser.loadTrack({
                                     //url: './data/gtex.txt', 
                                    url: './data/gtex-sorted.txt.gz',
                                    indexURL: './data/gtex-sorted.txt.gz.tbi',
                                    name: 'GTEx', //GTEx Whole_Blood
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [5e-8, 5e-4, 0.05],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'GTEx'});
            }

            else if(datasetvalues[i] == 13) {
              

                igv.browser.loadTrack({
                                    //url: './data/westra-hg19.txt',
                                    url: './data/westra-sorted.txt.gz',
                                    indexURL: './data/westra-sorted.txt.gz.tbi',
                                    name: 'Westra',
                                    format: 'gtexGWAS', //'gtf',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    //featureType: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Westra'}); 
            }

            else if(datasetvalues[i] == 14) {
                igv.browser.loadTrack({
                                    url: './data/lude/lude-sorted.txt.gz',
                                    indexURL: './data/lude/lude-sorted.txt.gz.tbi',
                                    name: 'Lude',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Lude'});
            }

            else if(datasetvalues[i] == 15) {
                igv.browser.loadTrack({
                                    url: './data/pierce/pierce-cis-temp-sorted.txt.gz',
                                    indexURL: './data/pierce/pierce-cis-temp-sorted.txt.gz.tbi',
                                    name: 'Pierce',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Pierce'});
            }

            else if(datasetvalues[i] == 16) {
                igv.browser.loadTrack({
                                    //url: './data/yamada/yamada-cis.txt',
                                    url: './data/yamada/yamada-sorted.txt.gz',
                                    indexURL: './data/yamada/yamada-sorted.txt.gz.tbi',
                                    name: 'Yamada',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Yamada'});
            }

            else if(datasetvalues[i] == 21) {             
                igv.browser.loadTrack({
                                    url: './data/jager/monocytes-aa-sorted.txt.gz',
                                    indexURL: './data/jager/monocytes-aa-sorted.txt.gz.tbi',
                                    name: 'Mono-AA',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    }, 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'MonoAA'});
            }

            else if(datasetvalues[i] == 22) {
                igv.browser.loadTrack({
                                    url: './data/jager/monocytes-ea-sorted.txt.gz',
                                    indexURL: './data/jager/monocytes-ea-sorted.txt.gz.tbi',
                                    name: 'mono-EA',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                  
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'MonoEA'});
            }

            else if(datasetvalues[i] == 23) {            
                igv.browser.loadTrack({
                                    url: './data/jager/monocytes-eu-sorted.txt.gz',
                                    indexURL: './data/jager/monocytes-eu-sorted.txt.gz.tbi',
                                    name: 'mono-EU',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'MonoEU'});
            }

            else if(datasetvalues[i] == 25) {           
                igv.browser.loadTrack({
                                    url: './data/fairfax/mono-sorted.txt.gz',
                                    indexURL: './data/fairfax/mono-sorted.txt.gz.tbi',
                                    name: 'mono-fairfax',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'MonoFairfax'});

            }

            else if(datasetvalues[i] == 26) {            
                igv.browser.loadTrack({
                                    url: './data/fairfax/mono-cis-naive-sorted.txt.gz',
                                    indexURL: './data/fairfax/mono-cis-naive-sorted.txt.gz.tbi',
                                    name: 'mono-fairfax-EurAme',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                  
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'MonoFairfax-EurAme'});
            }

            else if(datasetvalues[i] == 31) {               
                igv.browser.loadTrack({
                                    url: './data/jager/cd4T-aa-sorted.txt.gz',
                                    indexURL: './data/jager/cd4T-aa-sorted.txt.gz.tbi',
                                    name: 'cd4T-aa',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'cd4T-AA'});
            }

            else if(datasetvalues[i] == 32) {           
                igv.browser.loadTrack({
                                    url: './data/jager/cd4T-ea-sorted.txt.gz',
                                    indexURL: './data/jager/cd4T-ea-sorted.txt.gz.tbi',
                                    name: 'cd4T-ea',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'cd4T-EA'});
            }

            else if(datasetvalues[i] == 33) {
                igv.browser.loadTrack({
                                    url: './data/jager/cd4T-eu-sorted.txt.gz',
                                    indexURL: './data/jager/cd4T-eu-sorted.txt.gz.tbi',
                                    name: 'cd4T-eu',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                   
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'cd4T-EU'});
            }

            else if(datasetvalues[i] == 41) {                
                igv.browser.loadTrack({
                                    url: './data/fairfax/bcell-sorted.txt.gz',
                                    indexURL: './data/fairfax/bcell-sorted.txt.gz.tbi',
                                    name: 'Bcell',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                  
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Bcell'});
            }

            else if(datasetvalues[i] == 51) {            
                igv.browser.loadTrack({
                                    url: './data/fairfax/neutrophils-cis-final-sorted.txt.gz',
                                    indexURL: './data/fairfax/neutrophils-cis-final-sorted.txt.gz.tbi',
                                    name: 'neutrophils',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                 
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Neutrophils'});
            }
       
            else if(datasetvalues[i] == 61) {              
                igv.browser.loadTrack({
                                    url: './data/fairfax/mono-cis-lps2-sorted.txt.gz',
                                    indexURL: './data/fairfax/mono-cis-lps2-sorted.txt.gz.tbi',
                                    name: 'mono-LPS2h-EurAme',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Mono-LPS2h-EurAme'});           
            }

            else if(datasetvalues[i] == 62) {              
               igv.browser.loadTrack({
                                    url: './data/fairfax/mono-cis-lps24-sorted.txt.gz',
                                    indexURL: './data/fairfax/mono-cis-lps24-sorted.txt.gz.tbi',
                                    name: 'mono-LPS24h-EurAme',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Mono-LPS24h-EurAme'});               
            }

            else if(datasetvalues[i] == 63) {          
                igv.browser.loadTrack({
                                    url: './data/fairfax/mono-cis-ifn-sorted.txt.gz',
                                    indexURL: './data/fairfax/mono-cis-ifn-sorted.txt.gz.tbi',
                                    name: 'mono-IFNgamma-EurAme',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Mono-IFNgamma-EurAme'});
            }

            else if(datasetvalues[i] == 71) {              
                igv.browser.loadTrack({
                                    url: './data/dermitzakis/euro-temp-sorted.txt.gz',
                                    indexURL: './data/dermitzakis/euro-temp-sorted.txt.gz.tbi',
                                    name: 'LCL-European',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'LCL-European'});           
            }

            else if(datasetvalues[i] == 72) {              
               igv.browser.loadTrack({
                                    url: './data/dermitzakis/yri-temp-sorted.txt.gz',
                                    indexURL: './data/dermitzakis/yri-temp-sorted.txt.gz.tbi',
                                    name: 'LCL-African',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'LCL-African'});               
            }

            else if(datasetvalues[i] == 81) {              
                igv.browser.loadTrack({
                                    url: './data/heijmans/meqtl-sorted.txt.gz',
                                    indexURL: './data/heijmans/meqtl-sorted.txt.gz.tbi',
                                    name: 'meQTL',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'meQTL'});           
            }

            else if(datasetvalues[i] == 82) {              
               igv.browser.loadTrack({
                                    url: './data/heijmans/eqtm-sorted.txt.gz',
                                    indexURL: './data/heijmans/eqtm-sorted.txt.gz.tbi',
                                    name: 'eQTM',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'eQTM'});               
            }

            else if(datasetvalues[i] == 101) {              
                igv.browser.loadTrack({
                                    url: './data/user/user1-sorted.txt.gz',
                                    indexURL: './data/user/user1-sorted.txt.gz.tbi',
                                    name: 'user1',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'user1'});           
            }

            else if(datasetvalues[i] == 102) {              
               igv.browser.loadTrack({
                                    url: './data/user/user2-sorted.txt.gz',
                                    indexURL: './data/user/user2-sorted.txt.gz.tbi',
                                    name: 'user2',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'user2'});               
            }

            else if(datasetvalues[i] == 103) {              
                igv.browser.loadTrack({
                                    url: './data/user/user3-sorted.txt.gz',
                                    indexURL: './data/user/user3-sorted.txt.gz.tbi',
                                    name: 'user3',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'user3'});           
            }

            else if(datasetvalues[i] == 201) {              
               igv.browser.loadTrack({
                                    url: './data/emory/cis-day0.txt',
                                    name: 'Emory-Day0',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Emory-Day0'});               
            }

            else if(datasetvalues[i] == 202) {              
               igv.browser.loadTrack({
                                    url: './data/emory/cis-day1.txt',
                                    name: 'Emory-Day1',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Emory-Day1'});               
            }

            else if(datasetvalues[i] == 203) {              
               igv.browser.loadTrack({
                                    url: './data/emory/cis-day3.txt',
                                    name: 'Emory-Day3',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Emory-Day3'});               
            }

            else if(datasetvalues[i] == 204) {              
               igv.browser.loadTrack({
                                    url: './data/emory/cis-day7.txt',
                                    name: 'Emory-Day7',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Emory-Day7'});               
            }

            else if(datasetvalues[i] == 205) {              
               igv.browser.loadTrack({
                                    url: './data/emory/cis-day14.txt',
                                    name: 'Emory-Day14',
                                    format: 'gtexGWAS',
                                    sourceType: 'file',
                                    type: 'gwas',
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },                                
                                    maxLogP: 16,
                                    height: 150,
                                    commonCis: CommonCisData,
                                    label: 'Emory-Day14'});               
            }

           /* igv.browser.loadTrack({
                                     url: './data/GWAS_catalog_SNPs_Pval5E08_hg19_040115_subset.txt',
                                    featureType: 'annotation',
                                format: 'gwasSNPS',
                                    featureType: 'gwas',
                                    //indexed: false,
                                colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                //displayMode: 'EXPANDED',
                                    //commonCis: CommonCisData,
                                    label: 'GWAS'}); */

            //Load GWAS Data
           /* igv.browser.loadTrack({
                                     url: './data/GWAS_catalog_SNPs_Pval5E08_hg19_040115_subset.txt',
                                    name: 'GWAS',
                                    format: 'gtexGWAS',
                                    featureType: 'gwas',
                                    colorScale:  {
                                        thresholds: [5e-8, 5e-4, 0.05],
                                        colors: ['rgb(0,102,51)', 'rgb(122,179,23)', 'rgb(158,213,76)', 'rgb(227,238,249)']
                                    },
                                    colorScale: {
                                        thresholds: [],
                                        colors:['rgb(30,144,255)']
                                    },
                                    //minLogP: 4,
                                    maxLogP: 16,
                                    height: 150,
                                    //commonCis: CommonCisData,
                                    label: 'GWAS'}); */
           

        }


    }


    function calcCommonCis(geneCis)
    {
        var frequency = {}, source = {}, value, src;

        // compute frequencies of each value
        for(var i = 0; i < geneCis.length; i++) {
            value = geneCis[i].snp;
            src = geneCis[i].source;
            
            if(value in frequency) {
                if(source[value] != src)
                    frequency[value]++;
            }
            
            else {
                frequency[value] = 1;
                source[value] = src;
            }
        }

        var common = [];

        for(value in frequency) {
            if(frequency[value] >= 2)
                common.push(value);
        }

        return common;
    }


    function calcCommonTrans(geneSetData)
    {
        var snpData = [], junkArr = [], snpObj = {}, frequency = {}, source = {}, value, gene, pValue, snppos, genepos, geneObj = {}, index = {}, snp = [];

        // compute frequencies of each value
        for(var i = 0; i < geneSetData.length; i++) {
            value = geneSetData[i].SNPName;
            snp = [];
            //snp.push(value);
            gene = geneSetData[i].Gene;
            pValue = geneSetData[i].PValue;
            snppos = geneSetData[i].SNPChr + ":" + geneSetData[i].SNPChrPos; 
            genepos = geneSetData[i].ProbeChr + ":" + geneSetData[i].ProbeCenterChrPos;

            if(value in frequency) {
                if(source[value].Gene != gene)
                    frequency[value]++;
                    
                geneObj = {Pvalue: pValue, rsid: value, SNPPos: snppos, Gene: gene, GenePos: genepos};
                //snp.push(geneObj);
                source[value].push(geneObj);// = snp;
            }
            
            else {
                frequency[value] = 1;
                geneObj = {Pvalue: pValue, rsid: value, SNPPos: snppos, Gene: gene, GenePos: genepos};
                
                snp.push(geneObj);
                source[value] = snp; //push(geneObj);
                //index[value] = i;
            }
        }

        var common = [];
        //console.log("FREQUENCY: ", frequency);
        //console.log("SOURCE: ", source);
        for(value in frequency) {
            if(frequency[value] >= 2)
                ;//console.log("Frequency: ", frequency[value], " --- SNP: ", value, " Genes: ", source[value]);
                //common.push(value);
        }

        //return common;
        geneSetTrans(frequency, source);
    }


</script>

</body>

</html>
